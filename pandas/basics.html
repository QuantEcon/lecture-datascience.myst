

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Basic Functionality &#8212; QuantEcon DataScience</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/quantecon-book-theme.css?digest=bd0785fbb14d8d2bd4d9ae501d79ed8d3bc089ec" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/scripts/quantecon-book-theme.js?digest=d6d86bce9979111653c4c495e33499e1796e172a"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-S8CBQPC844"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-S8CBQPC844');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pandas/basics';</script>
    <link rel="canonical" href="https://datascience.quantecon.org/pandas/basics.html" />
    <link rel="shortcut icon" href="../_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Index" href="the_index.html" />
    <link rel="prev" title="Introduction" href="intro.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Chase Coleman, Spencer Lyon, and Jesse Perla" />
<meta name="keywords" content="Python, QuantEcon, DataScience" />
<meta name="description" content=This website presents a series of lectures on programming, data science, and economics. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Basic Functionality"/>
<meta name="twitter:description" content="This website presents a series of lectures on programming, data science, and economics.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Basic Functionality" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://datascience.quantecon.org/pandas/basics.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a series of lectures on programming, data science, and economics." />
<meta property="og:site_name" content="QuantEcon DataScience" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>

<!-- Override QuantEcon theme colors -->

    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=pandas/basics>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#state-unemployment-data">State Unemployment Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dates-in-pandas">Dates in pandas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe-aggregations">DataFrame Aggregations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#built-in-aggregations">Built-in Aggregations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#writing-your-own-aggregation">Writing Your Own Aggregation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transforms">Transforms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#built-in-transforms">Built-in Transforms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-series-transforms">Custom Series Transforms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-scalar-transforms">Custom Scalar Transforms</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boolean-selection">Boolean Selection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-boolean-dataframes-series">Creating Boolean DataFrames/Series</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-conditions">Multiple Conditions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#isin"><code class="docutils literal notranslate"><span class="pre">isin</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#any-and-all"><code class="docutils literal notranslate"><span class="pre">.any</span></code> and <code class="docutils literal notranslate"><span class="pre">.all</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
</ul>
</li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="../_static/datascience-logo.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="../index.html">QuantEcon DataScience</a></p>

                        <p class="qe-page__header-subheading">Basic Functionality</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">Chase Coleman, Spencer Lyon, and Jesse Perla</p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="basic-functionality">
<h1>Basic Functionality<a class="headerlink" href="#basic-functionality" title="Permalink to this heading">#</a></h1>
<p><strong>Prerequisites</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="intro.html"><span class="doc">pandas Intro</span></a></p></li>
</ul>
<p><strong>Outcomes</strong></p>
<ul class="simple">
<li><p>Be familiar with <code class="docutils literal notranslate"><span class="pre">datetime</span></code></p></li>
<li><p>Use built-in aggregation functions and be able to create your own and
apply them using <code class="docutils literal notranslate"><span class="pre">agg</span></code></p></li>
<li><p>Use built-in Series transformation functions and be able to create your
own and apply them using <code class="docutils literal notranslate"><span class="pre">apply</span></code></p></li>
<li><p>Use built-in scalar transformation functions and be able to create your
own and apply them using <code class="docutils literal notranslate"><span class="pre">map</span></code></p></li>
<li><p>Be able to select subsets of the DataFrame using boolean selection</p></li>
<li><p>Know what the “want operator” is and how to apply it</p></li>
</ul>
<p><strong>Data</strong></p>
<ul class="simple">
<li><p>US state unemployment data from Bureau of Labor Statistics</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment following line to install on colab</span>
<span class="c1">#! pip install </span>
</pre></div>
</div>
<section id="state-unemployment-data">
<h2>State Unemployment Data<a class="headerlink" href="#state-unemployment-data" title="Permalink to this heading">#</a></h2>
<p>In this lecture, we will use unemployment data by state at a monthly
frequency.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">pd</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;2.2.3&#39;
</pre></div>
</div>
</div>
</div>
<p>First, we will download the data directly from a url and read it into a pandas DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Load up the data -- this will take a couple seconds</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://datascience.quantecon.org/assets/data/state_unemployment.csv&quot;</span>
<span class="n">unemp_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>The pandas <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> will determine most datatypes of the underlying columns.  The
exception here is that we need to give pandas a hint so it can load up the <code class="docutils literal notranslate"><span class="pre">Date</span></code> column as a Python datetime type: the <code class="docutils literal notranslate"><span class="pre">parse_dates=[&quot;Date&quot;]</span></code>.</p>
<p>We can see the basic structure of the downloaded data by getting the first 5 rows, which directly matches
the underlying CSV file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_raw</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>state</th>
      <th>LaborForce</th>
      <th>UnemploymentRate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>Alabama</td>
      <td>2142945.0</td>
      <td>4.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-01</td>
      <td>Alaska</td>
      <td>319059.0</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-01</td>
      <td>Arizona</td>
      <td>2499980.0</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-01</td>
      <td>Arkansas</td>
      <td>1264619.0</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-01</td>
      <td>California</td>
      <td>16680246.0</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that a row has a date, state, labor force size, and unemployment rate.</p>
<p>For our analysis, we want to look at the unemployment rate across different states over time, which
requires a transformation of the data similar to an Excel pivot-table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Don&#39;t worry about the details here quite yet</span>
<span class="n">unemp_all</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">unemp_raw</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;UnemploymentRate&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">unemp_all</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Alabama</th>
      <th>Alaska</th>
      <th>Arizona</th>
      <th>Arkansas</th>
      <th>California</th>
      <th>Colorado</th>
      <th>Connecticut</th>
      <th>Delaware</th>
      <th>Florida</th>
      <th>Georgia</th>
      <th>...</th>
      <th>South Dakota</th>
      <th>Tennessee</th>
      <th>Texas</th>
      <th>Utah</th>
      <th>Vermont</th>
      <th>Virginia</th>
      <th>Washington</th>
      <th>West Virginia</th>
      <th>Wisconsin</th>
      <th>Wyoming</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.7</td>
      <td>6.3</td>
      <td>4.1</td>
      <td>4.4</td>
      <td>5.0</td>
      <td>2.8</td>
      <td>2.8</td>
      <td>3.5</td>
      <td>3.7</td>
      <td>3.7</td>
      <td>...</td>
      <td>2.4</td>
      <td>3.7</td>
      <td>4.6</td>
      <td>3.1</td>
      <td>2.7</td>
      <td>2.6</td>
      <td>4.9</td>
      <td>5.8</td>
      <td>3.2</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.7</td>
      <td>6.3</td>
      <td>4.1</td>
      <td>4.3</td>
      <td>5.0</td>
      <td>2.8</td>
      <td>2.7</td>
      <td>3.6</td>
      <td>3.7</td>
      <td>3.6</td>
      <td>...</td>
      <td>2.4</td>
      <td>3.7</td>
      <td>4.6</td>
      <td>3.1</td>
      <td>2.6</td>
      <td>2.5</td>
      <td>4.9</td>
      <td>5.6</td>
      <td>3.2</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.6</td>
      <td>6.3</td>
      <td>4.0</td>
      <td>4.3</td>
      <td>5.0</td>
      <td>2.7</td>
      <td>2.6</td>
      <td>3.6</td>
      <td>3.7</td>
      <td>3.6</td>
      <td>...</td>
      <td>2.4</td>
      <td>3.8</td>
      <td>4.5</td>
      <td>3.1</td>
      <td>2.6</td>
      <td>2.4</td>
      <td>5.0</td>
      <td>5.5</td>
      <td>3.3</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.6</td>
      <td>6.3</td>
      <td>4.0</td>
      <td>4.3</td>
      <td>5.1</td>
      <td>2.7</td>
      <td>2.5</td>
      <td>3.7</td>
      <td>3.7</td>
      <td>3.7</td>
      <td>...</td>
      <td>2.4</td>
      <td>3.8</td>
      <td>4.4</td>
      <td>3.1</td>
      <td>2.7</td>
      <td>2.4</td>
      <td>5.0</td>
      <td>5.4</td>
      <td>3.4</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.5</td>
      <td>6.3</td>
      <td>4.0</td>
      <td>4.2</td>
      <td>5.1</td>
      <td>2.7</td>
      <td>2.4</td>
      <td>3.7</td>
      <td>3.7</td>
      <td>3.7</td>
      <td>...</td>
      <td>2.4</td>
      <td>3.9</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>2.7</td>
      <td>2.3</td>
      <td>5.1</td>
      <td>5.4</td>
      <td>3.5</td>
      <td>3.8</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 50 columns</p>
</div></div></div>
</div>
<p>Finally, we can filter it to look at a subset of the columns (i.e. “state” in this case).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Arizona&quot;</span><span class="p">,</span> <span class="s2">&quot;California&quot;</span><span class="p">,</span> <span class="s2">&quot;Florida&quot;</span><span class="p">,</span> <span class="s2">&quot;Illinois&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Michigan&quot;</span><span class="p">,</span> <span class="s2">&quot;New York&quot;</span><span class="p">,</span> <span class="s2">&quot;Texas&quot;</span>
<span class="p">]</span>
<span class="n">unemp</span> <span class="o">=</span> <span class="n">unemp_all</span><span class="p">[</span><span class="n">states</span><span class="p">]</span>
<span class="n">unemp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>When plotting, a DataFrame knows the column and index names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Date&#39;&gt;
</pre></div>
</div>
<img alt="../_images/b6fdadc80736ddecddbc484af0fa5266915e0cb74e8e216830e0ff6e23f17bfe.png" src="../_images/b6fdadc80736ddecddbc484af0fa5266915e0cb74e8e216830e0ff6e23f17bfe.png" />
</div>
</div>
<div class="admonition-exercise admonition" id="pd-bas-dir1">
<p class="admonition-title">Exercise</p>
<p>See exercise 1 in the <a class="reference internal" href="#pd-bas-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
</section>
<section id="dates-in-pandas">
<h2>Dates in pandas<a class="headerlink" href="#dates-in-pandas" title="Permalink to this heading">#</a></h2>
<p>You might have noticed that our index now has a nice format for the
dates (<code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span></code>) rather than just a year.</p>
<p>This is because the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of the index is a variant of <code class="docutils literal notranslate"><span class="pre">datetime</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2000-01-01&#39;, &#39;2000-02-01&#39;, &#39;2000-03-01&#39;, &#39;2000-04-01&#39;,
               &#39;2000-05-01&#39;, &#39;2000-06-01&#39;, &#39;2000-07-01&#39;, &#39;2000-08-01&#39;,
               &#39;2000-09-01&#39;, &#39;2000-10-01&#39;,
               ...
               &#39;2017-03-01&#39;, &#39;2017-04-01&#39;, &#39;2017-05-01&#39;, &#39;2017-06-01&#39;,
               &#39;2017-07-01&#39;, &#39;2017-08-01&#39;, &#39;2017-09-01&#39;, &#39;2017-10-01&#39;,
               &#39;2017-11-01&#39;, &#39;2017-12-01&#39;],
              dtype=&#39;datetime64[ns]&#39;, name=&#39;Date&#39;, length=216, freq=None)
</pre></div>
</div>
</div>
</div>
<p>We can index into a DataFrame with a <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> using string
representations of dates.</p>
<p>For example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data corresponding to a single date</span>
<span class="n">unemp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;01/01/2000&quot;</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state
Arizona       4.1
California    5.0
Florida       3.7
Illinois      4.2
Michigan      3.3
New York      4.7
Texas         4.6
Name: 2000-01-01 00:00:00, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data for all days between New Years Day and June first in the year 2000</span>
<span class="n">unemp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;01/01/2000&quot;</span><span class="p">:</span><span class="s2">&quot;06/01/2000&quot;</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
    <tr>
      <th>2000-06-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.8</td>
      <td>4.3</td>
      <td>3.7</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We will learn more about what pandas can do with dates and times in an
upcoming lecture on time series data.</p>
</section>
<section id="dataframe-aggregations">
<h2>DataFrame Aggregations<a class="headerlink" href="#dataframe-aggregations" title="Permalink to this heading">#</a></h2>
<p>Let’s talk about <em>aggregations</em>.</p>
<p>Loosely speaking, an aggregation is an operation that combines multiple
values into a single value.</p>
<p>For example, computing the mean of three numbers (for example
<code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2]</span></code>) returns a single number (1).</p>
<p>We will use aggregations extensively as we analyze and manipulate our data.</p>
<p>Thankfully, pandas makes this easy!</p>
<section id="built-in-aggregations">
<h3>Built-in Aggregations<a class="headerlink" href="#built-in-aggregations" title="Permalink to this heading">#</a></h3>
<p>pandas already has some of the most frequently used aggregations.</p>
<p>For example:</p>
<ul class="simple">
<li><p>Mean  (<code class="docutils literal notranslate"><span class="pre">mean</span></code>)</p></li>
<li><p>Variance (<code class="docutils literal notranslate"><span class="pre">var</span></code>)</p></li>
<li><p>Standard deviation (<code class="docutils literal notranslate"><span class="pre">std</span></code>)</p></li>
<li><p>Minimum (<code class="docutils literal notranslate"><span class="pre">min</span></code>)</p></li>
<li><p>Median (<code class="docutils literal notranslate"><span class="pre">median</span></code>)</p></li>
<li><p>Maximum (<code class="docutils literal notranslate"><span class="pre">max</span></code>)</p></li>
<li><p>etc…</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When looking for common operations, using “tab completion” goes a long way.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state
Arizona       6.301389
California    7.299074
Florida       6.048611
Illinois      6.822685
Michigan      7.492593
New York      6.102315
Texas         5.695370
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>As seen above, the aggregation’s default is to aggregate each column.</p>
<p>However, by using the <code class="docutils literal notranslate"><span class="pre">axis</span></code> keyword argument, you can do aggregations by
row as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01    0.352381
2000-02-01    0.384762
2000-03-01    0.364762
2000-04-01    0.353333
2000-05-01    0.294762
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="writing-your-own-aggregation">
<h3>Writing Your Own Aggregation<a class="headerlink" href="#writing-your-own-aggregation" title="Permalink to this heading">#</a></h3>
<p>The built-in aggregations will get us pretty far in our analysis, but
sometimes we need more flexibility.</p>
<p>We can have pandas perform custom aggregations by following these two
steps:</p>
<ol class="arabic simple">
<li><p>Write a Python function that takes a <code class="docutils literal notranslate"><span class="pre">Series</span></code> as an input and
outputs a single value.</p></li>
<li><p>Call the <code class="docutils literal notranslate"><span class="pre">agg</span></code> method with our new function as an argument.</p></li>
</ol>
<p>For example, below, we will classify states as “low unemployment” or
“high unemployment” based on whether their mean unemployment level is
above or below 6.5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Step 1: We write the (aggregation) function that we&#39;d like to use</span>
<span class="c1">#</span>
<span class="k">def</span><span class="w"> </span><span class="nf">high_or_low</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes a pandas Series object and returns high</span>
<span class="sd">    if the mean is above 6.5 and low if the mean is below 6.5</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">6.5</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;Low&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;High&quot;</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Step 2: Apply it via the agg method.</span>
<span class="c1">#</span>
<span class="n">unemp</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">high_or_low</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state
Arizona        Low
California    High
Florida        Low
Illinois      High
Michigan      High
New York       Low
Texas          Low
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># How does this differ from unemp.agg(high_or_low)?</span>
<span class="n">unemp</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">high_or_low</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01    Low
2000-02-01    Low
2000-03-01    Low
2000-04-01    Low
2000-05-01    Low
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">agg</span></code> can also accept multiple functions at once.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">high_or_low</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2992/286408109.py:1: FutureWarning: The provided callable &lt;built-in function min&gt; is currently using Series.min. In a future version of pandas, the provided callable will be used directly. To keep current behavior pass the string &quot;min&quot; instead.
  unemp.agg([min, max, high_or_low])
/tmp/ipykernel_2992/286408109.py:1: FutureWarning: The provided callable &lt;built-in function max&gt; is currently using Series.max. In a future version of pandas, the provided callable will be used directly. To keep current behavior pass the string &quot;max&quot; instead.
  unemp.agg([min, max, high_or_low])
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>min</th>
      <td>3.6</td>
      <td>4.5</td>
      <td>3.1</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.2</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>max</th>
      <td>10.9</td>
      <td>12.3</td>
      <td>11.3</td>
      <td>11.3</td>
      <td>14.6</td>
      <td>8.9</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>high_or_low</th>
      <td>Low</td>
      <td>High</td>
      <td>Low</td>
      <td>High</td>
      <td>High</td>
      <td>Low</td>
      <td>Low</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition-exercise admonition" id="pd-bas-dir2">
<p class="admonition-title">Exercise</p>
<p>See exercise 2 in the <a class="reference internal" href="#pd-bas-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
</section>
</section>
<section id="transforms">
<h2>Transforms<a class="headerlink" href="#transforms" title="Permalink to this heading">#</a></h2>
<p>Many analytical operations do not necessarily involve an aggregation.</p>
<p>The output of a function applied to a Series might need to be a new
Series.</p>
<p>Some examples:</p>
<ul class="simple">
<li><p>Compute the percentage change in unemployment from month to month.</p></li>
<li><p>Calculate the cumulative sum of elements in each column.</p></li>
</ul>
<section id="built-in-transforms">
<h3>Built-in Transforms<a class="headerlink" href="#built-in-transforms" title="Permalink to this heading">#</a></h3>
<p>pandas comes with many transform functions including:</p>
<ul class="simple">
<li><p>Cumulative sum/max/min/product (<code class="docutils literal notranslate"><span class="pre">cum(sum|min|max|prod)</span></code>)</p></li>
<li><p>Difference  (<code class="docutils literal notranslate"><span class="pre">diff</span></code>)</p></li>
<li><p>Elementwise addition/subtraction/multiplication/division (<code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">/</span></code>)</p></li>
<li><p>Percent change (<code class="docutils literal notranslate"><span class="pre">pct_change</span></code>)</p></li>
<li><p>Number of occurrences of each distinct value (<code class="docutils literal notranslate"><span class="pre">value_counts</span></code>)</p></li>
<li><p>Absolute value (<code class="docutils literal notranslate"><span class="pre">abs</span></code>)</p></li>
</ul>
<p>Again, tab completion is helpful when trying to find these functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">pct_change</span><span class="p">(</span><span class="n">fill_method</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># Skip calculation for missing data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>0.00000</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>-0.030303</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>-0.02439</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.02381</td>
      <td>0.000000</td>
      <td>-0.021277</td>
      <td>-0.021739</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>0.00000</td>
      <td>0.02</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.031250</td>
      <td>0.000000</td>
      <td>-0.022222</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>0.00000</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.060606</td>
      <td>0.000000</td>
      <td>-0.022727</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.1</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>-0.1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>-0.1</td>
      <td>-0.1</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>0.0</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>-0.1</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>0.0</td>
      <td>-0.1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Transforms can be split into to several main categories:</p>
<ol class="arabic simple">
<li><p><em>Series transforms</em>: functions that take in one Series and produce another Series. The index of the input and output does not need to be the same.</p></li>
<li><p><em>Scalar transforms</em>: functions that take a single value and produce a single value. An example is the <code class="docutils literal notranslate"><span class="pre">abs</span></code> method, or adding a constant to each value of a Series.</p></li>
</ol>
</section>
<section id="custom-series-transforms">
<h3>Custom Series Transforms<a class="headerlink" href="#custom-series-transforms" title="Permalink to this heading">#</a></h3>
<p>pandas also simplifies applying custom Series transforms to a Series or the
columns of a DataFrame. The steps are:</p>
<ol class="arabic simple">
<li><p>Write a Python function that takes a Series and outputs a new Series.</p></li>
<li><p>Pass our new function as an argument to the <code class="docutils literal notranslate"><span class="pre">apply</span></code> method (alternatively, the <code class="docutils literal notranslate"><span class="pre">transform</span></code> method).</p></li>
</ol>
<p>As an example, we will standardize our unemployment data to have mean 0
and standard deviation 1.</p>
<p>After doing this, we can use an aggregation to determine at which date the
unemployment rate is most different from “normal times” for each state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Step 1: We write the Series transform function that we&#39;d like to use</span>
<span class="c1">#</span>
<span class="k">def</span><span class="w"> </span><span class="nf">standardize_data</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Changes the data in a Series to become mean 0 with standard deviation 1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">std</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Step 2: Apply our function via the apply method.</span>
<span class="c1">#</span>
<span class="n">std_unemp</span> <span class="o">=</span> <span class="n">unemp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">standardize_data</span><span class="p">)</span>
<span class="n">std_unemp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>-1.076861</td>
      <td>-0.935545</td>
      <td>-0.976846</td>
      <td>-1.337203</td>
      <td>-1.605740</td>
      <td>-0.925962</td>
      <td>-0.849345</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>-1.076861</td>
      <td>-0.935545</td>
      <td>-0.976846</td>
      <td>-1.337203</td>
      <td>-1.644039</td>
      <td>-0.925962</td>
      <td>-0.849345</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>-1.125778</td>
      <td>-0.935545</td>
      <td>-0.976846</td>
      <td>-1.286217</td>
      <td>-1.644039</td>
      <td>-0.991993</td>
      <td>-0.926885</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>-1.125778</td>
      <td>-0.894853</td>
      <td>-0.976846</td>
      <td>-1.286217</td>
      <td>-1.605740</td>
      <td>-0.991993</td>
      <td>-1.004424</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>-1.125778</td>
      <td>-0.894853</td>
      <td>-0.976846</td>
      <td>-1.286217</td>
      <td>-1.529141</td>
      <td>-0.991993</td>
      <td>-1.081964</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Takes the absolute value of all elements of a function</span>
<span class="n">abs_std_unemp</span> <span class="o">=</span> <span class="n">std_unemp</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>

<span class="n">abs_std_unemp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>1.076861</td>
      <td>0.935545</td>
      <td>0.976846</td>
      <td>1.337203</td>
      <td>1.605740</td>
      <td>0.925962</td>
      <td>0.849345</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>1.076861</td>
      <td>0.935545</td>
      <td>0.976846</td>
      <td>1.337203</td>
      <td>1.644039</td>
      <td>0.925962</td>
      <td>0.849345</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>1.125778</td>
      <td>0.935545</td>
      <td>0.976846</td>
      <td>1.286217</td>
      <td>1.644039</td>
      <td>0.991993</td>
      <td>0.926885</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>1.125778</td>
      <td>0.894853</td>
      <td>0.976846</td>
      <td>1.286217</td>
      <td>1.605740</td>
      <td>0.991993</td>
      <td>1.004424</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>1.125778</td>
      <td>0.894853</td>
      <td>0.976846</td>
      <td>1.286217</td>
      <td>1.529141</td>
      <td>0.991993</td>
      <td>1.081964</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># find the date when unemployment was &quot;most different from normal&quot; for each State</span>
<span class="k">def</span><span class="w"> </span><span class="nf">idxmax</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># idxmax of Series will return index of maximal value</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>

<span class="n">abs_std_unemp</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">idxmax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state
Arizona      2009-11-01
California   2010-03-01
Florida      2010-01-01
Illinois     2009-12-01
Michigan     2009-06-01
New York     2009-11-01
Texas        2009-08-01
dtype: datetime64[ns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="custom-scalar-transforms">
<h3>Custom Scalar Transforms<a class="headerlink" href="#custom-scalar-transforms" title="Permalink to this heading">#</a></h3>
<p>As you may have predicted, we can also apply custom scalar transforms to our
pandas data.</p>
<p>To do this, we use the following pattern:</p>
<ol class="arabic simple">
<li><p>Define a Python function that takes in a scalar and produces a scalar.</p></li>
<li><p>Pass this function as an argument to the <code class="docutils literal notranslate"><span class="pre">map</span></code> Series or DataFrame method.</p></li>
</ol>
<p>Complete the exercise below to practice writing and using your own scalar
transforms.</p>
<div class="admonition-exercise admonition" id="pd-bas-dir3">
<p class="admonition-title">Exercise</p>
<p>See exercise 3 in the <a class="reference internal" href="#pd-bas-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
</section>
</section>
<section id="boolean-selection">
<h2>Boolean Selection<a class="headerlink" href="#boolean-selection" title="Permalink to this heading">#</a></h2>
<p>We have seen how we can select subsets of data by referring to the index
or column names.</p>
<p>However, we often want to select based on conditions met by
the data itself.</p>
<p>Some examples are:</p>
<ul class="simple">
<li><p>Restrict analysis to all individuals older than 18.</p></li>
<li><p>Look at data that corresponds to particular time periods.</p></li>
<li><p>Analyze only data that corresponds to a recession.</p></li>
<li><p>Obtain data for a specific product or customer ID.</p></li>
</ul>
<p>We will be able to do this by using a Series or list of boolean values
to index into a Series or DataFrame.</p>
<p>Let’s look at some examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_small</span> <span class="o">=</span> <span class="n">unemp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>  <span class="c1"># Create smaller data so we can see what&#39;s happening</span>
<span class="n">unemp_small</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># list of booleans selects rows</span>
<span class="n">unemp_small</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># second argument selects columns, the  ``:``  means &quot;all&quot;.</span>
<span class="c1"># here we use it to select all columns</span>
<span class="n">unemp_small</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># can use booleans to select both rows and columns</span>
<span class="n">unemp_small</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="creating-boolean-dataframes-series">
<h3>Creating Boolean DataFrames/Series<a class="headerlink" href="#creating-boolean-dataframes-series" title="Permalink to this heading">#</a></h3>
<p>We can use <a class="reference internal" href="../python_fundamentals/control_flow.html"><span class="doc">conditional statements</span></a> to
construct Series of booleans from our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Texas&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">4.5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01    False
2000-02-01    False
2000-03-01    False
2000-04-01     True
2000-05-01     True
Name: Texas, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>Once we have our Series of bools, we can use it to extract subsets of
rows from our DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_small</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Texas&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">4.5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;New York&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Texas&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01    True
2000-02-01    True
2000-03-01    True
2000-04-01    True
2000-05-01    True
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_NY</span> <span class="o">=</span> <span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;New York&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Texas&quot;</span><span class="p">]</span>
<span class="n">unemp_small</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">big_NY</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="multiple-conditions">
<h4>Multiple Conditions<a class="headerlink" href="#multiple-conditions" title="Permalink to this heading">#</a></h4>
<p>In the boolean section of the <a class="reference internal" href="../python_fundamentals/basics.html"><span class="doc">basics lecture</span></a>, we saw
that we can use the words <code class="docutils literal notranslate"><span class="pre">and</span></code> and <code class="docutils literal notranslate"><span class="pre">or</span></code> to combine multiple booleans into
a single bool.</p>
<p>Recall:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span> <span class="pre">and</span> <span class="pre">False</span> <span class="pre">-&gt;</span> <span class="pre">False</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">True</span> <span class="pre">and</span> <span class="pre">True</span> <span class="pre">-&gt;</span> <span class="pre">True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span> <span class="pre">and</span> <span class="pre">False</span> <span class="pre">-&gt;</span> <span class="pre">False</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">True</span> <span class="pre">or</span> <span class="pre">False</span> <span class="pre">-&gt;</span> <span class="pre">True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">True</span> <span class="pre">or</span> <span class="pre">True</span> <span class="pre">-&gt;</span> <span class="pre">True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span> <span class="pre">or</span> <span class="pre">False</span> <span class="pre">-&gt;</span> <span class="pre">False</span></code></p></li>
</ul>
<p>We can do something similar in pandas, but instead of
<code class="docutils literal notranslate"><span class="pre">bool1</span> <span class="pre">and</span> <span class="pre">bool2</span></code> we write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">bool_series1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">bool_series2</span><span class="p">)</span>
</pre></div>
</div>
<p>Likewise, instead of <code class="docutils literal notranslate"><span class="pre">bool1</span> <span class="pre">or</span> <span class="pre">bool2</span></code> we write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">bool_series1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">bool_series2</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_NYTX</span> <span class="o">=</span> <span class="p">(</span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Texas&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">4.7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;New York&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">4.7</span><span class="p">)</span>
<span class="n">small_NYTX</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01    False
2000-02-01    False
2000-03-01     True
2000-04-01     True
2000-05-01     True
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_small</span><span class="p">[</span><span class="n">small_NYTX</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="isin">
<h4><code class="docutils literal notranslate"><span class="pre">isin</span></code><a class="headerlink" href="#isin" title="Permalink to this heading">#</a></h4>
<p>Sometimes, we will want to check whether a data point takes on one of a
several fixed values.</p>
<p>We could do this by writing <code class="docutils literal notranslate"><span class="pre">(df[&quot;x&quot;]</span> <span class="pre">==</span> <span class="pre">val_1)</span> <span class="pre">|</span> <span class="pre">(df[&quot;x&quot;]</span> <span class="pre">==</span> <span class="pre">val_2)</span></code>
(like we did above), but there is a better way: the <code class="docutils literal notranslate"><span class="pre">.isin</span></code> method</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Michigan&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mf">3.3</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01     True
2000-02-01     True
2000-03-01     True
2000-04-01     True
2000-05-01    False
Name: Michigan, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now select full rows where this Series is True</span>
<span class="n">unemp_small</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Michigan&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mf">3.3</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="any-and-all">
<h4><code class="docutils literal notranslate"><span class="pre">.any</span></code> and <code class="docutils literal notranslate"><span class="pre">.all</span></code><a class="headerlink" href="#any-and-all" title="Permalink to this heading">#</a></h4>
<p>Recall from the boolean section of the <a class="reference internal" href="../python_fundamentals/basics.html"><span class="doc">basics lecture</span></a>
that the Python functions <code class="docutils literal notranslate"><span class="pre">any</span></code> and <code class="docutils literal notranslate"><span class="pre">all</span></code> are aggregation functions that
take a collection of booleans and return a single boolean.</p>
<p><code class="docutils literal notranslate"><span class="pre">any</span></code> returns True whenever at least one of the inputs are True while
<code class="docutils literal notranslate"><span class="pre">all</span></code> is True only when all the inputs are <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Series and DataFrames with <code class="docutils literal notranslate"><span class="pre">dtype</span></code> bool have <code class="docutils literal notranslate"><span class="pre">.any</span></code> and <code class="docutils literal notranslate"><span class="pre">.all</span></code>
methods that apply this logic to pandas objects.</p>
<p>Let’s use these methods to count how many months all the states in our
sample had high unemployment.</p>
<p>As we work through this example, consider the <a class="reference external" href="http://albertjmenkveld.com/2014/07/07/endogeneous-price-dispersion/">“want
operator”</a>, a helpful
concept from Nobel Laureate <a class="reference external" href="http://www.tomsargent.com">Tom
Sargent</a> for clearly stating the goal of our analysis and
determining the steps necessary to reach the goal.</p>
<p>We always begin by writing <code class="docutils literal notranslate"><span class="pre">Want:</span></code> followed by what we want to
accomplish.</p>
<p>In this case, we would write:</p>
<blockquote>
<div><p>Want: Count the number of months in which all states in our sample
had unemployment above 6.5%</p>
</div></blockquote>
<p>After identifying the <strong>want</strong>, we work <em>backwards</em> to identify the
steps necessary to accomplish our goal.</p>
<p>So, starting from the result, we have:</p>
<ol class="arabic simple">
<li><p>Sum the number of <code class="docutils literal notranslate"><span class="pre">True</span></code> values in a Series indicating dates for
which all states had high unemployment.</p></li>
<li><p>Build the Series used in the last step by using the <code class="docutils literal notranslate"><span class="pre">.all</span></code> method
on a DataFrame containing booleans indicating whether each state had
high unemployment at each date.</p></li>
<li><p>Build the DataFrame used in the previous step using a <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>
comparison.</p></li>
</ol>
<p>Now that we have a clear plan, let’s follow through and <em>apply</em> the want
operator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 3: construct the DataFrame of bools</span>
<span class="n">high</span> <span class="o">=</span> <span class="n">unemp</span> <span class="o">&gt;</span> <span class="mf">6.5</span>
<span class="n">high</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 2: use the .all method on axis=1 to get the dates where all states have a True</span>
<span class="n">all_high</span> <span class="o">=</span> <span class="n">high</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">all_high</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01    False
2000-02-01    False
2000-03-01    False
2000-04-01    False
2000-05-01    False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 1: Call .sum to add up the number of True values in `all_high`</span>
<span class="c1">#         (note that True == 1 and False == 0 in Python, so .sum will count Trues)</span>
<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Out of </span><span class="si">{}</span><span class="s2"> months, </span><span class="si">{}</span><span class="s2"> had high unemployment across all states&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_high</span><span class="p">),</span> <span class="n">all_high</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Out of 216 months, 41 had high unemployment across all states
</pre></div>
</div>
</div>
</div>
<div class="admonition-exercise admonition" id="pd-bas-dir4">
<p class="admonition-title">Exercise</p>
<p>See exercise 4 in the <a class="reference internal" href="#pd-bas-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
</section>
</section>
</section>
<section id="exercises">
<span id="pd-bas-ex"></span><h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this heading">#</a></h3>
<p>Looking at the displayed DataFrame above, can you identify the index? The columns?</p>
<p>You can use the cell below to verify your visual intuition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here</span>
</pre></div>
</div>
</div>
</div>
<p>(<a class="reference internal" href="#pd-bas-dir1"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this heading">#</a></h3>
<p>Do the following exercises in separate code cells below:</p>
<ul>
<li><p>At each date, what is the minimum unemployment rate across all states
in our sample?</p></li>
<li><p>What was the median unemployment rate in each state?</p></li>
<li><p>What was the maximum unemployment rate across the states in our
sample? What state did it happen in? In what month/year was this
achieved?</p>
<ul>
<li><div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>What Python type (not <code class="docutils literal notranslate"><span class="pre">dtype</span></code>) is returned by the aggregation?</p>
</div>
</li>
<li><div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Read documentation for the method <code class="docutils literal notranslate"><span class="pre">idxmax</span></code>.</p>
</div>
</li>
</ul>
</li>
<li><p>Classify each state as high or low volatility based on whether the
variance of their unemployment is above or below 4.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># min unemployment rate by state</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># median unemployment rate by state</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># max unemployment rate across all states and Year</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># low or high volatility</span>
</pre></div>
</div>
</div>
</div>
<p>(<a class="reference internal" href="#pd-bas-dir2"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-3">
<h3>Exercise 3<a class="headerlink" href="#exercise-3" title="Permalink to this heading">#</a></h3>
<p>Imagine that we want to determine whether unemployment was high (&gt; 6.5),
medium (4.5 &lt; x &lt;= 6.5), or low (&lt;= 4.5) for each state and each month.</p>
<ol class="arabic">
<li><p>Write a Python function that takes a single number as an input and
outputs a single string noting if that number is high, medium, or low.</p></li>
<li><p>Pass your function to <code class="docutils literal notranslate"><span class="pre">map</span></code> (quiz: why <code class="docutils literal notranslate"><span class="pre">map</span></code> and not
<code class="docutils literal notranslate"><span class="pre">agg</span></code> or <code class="docutils literal notranslate"><span class="pre">apply</span></code>?) and save the result in a new DataFrame called
<code class="docutils literal notranslate"><span class="pre">unemp_bins</span></code>.</p></li>
<li><p>(Challenging) This exercise has multiple parts:</p>
<ol class="arabic">
<li><p>Use another transform on <code class="docutils literal notranslate"><span class="pre">unemp_bins</span></code> to count how many
times each state had each of the three classifications.</p>
<ul>
<li><div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Will this value counting function be a Series or scalar transform?</p>
</div>
</li>
<li><div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Try googling “pandas count unique value” or something similar to find the right transform.</p>
</div>
</li>
</ul>
</li>
<li><p>Construct a horizontal bar chart of the number of occurrences of
each level with one bar per state and classification (21 total
bars).</p></li>
</ol>
</li>
<li><p>(Challenging) Repeat the previous step, but count how many states had
each classification in each month. Which month had the most states
with high unemployment? What about medium and low?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part 1: Write a Python function to classify unemployment levels.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part 2: Pass your function from part 1 to map</span>
<span class="n">unemp_bins</span> <span class="o">=</span> <span class="n">unemp</span><span class="o">.</span><span class="n">map</span><span class="c1">#replace this comment with your code!!</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part 3: Count the number of times each state had each classification.</span>

<span class="c1">## then make a horizontal bar chart here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part 4: Apply the same transform from part 4, but to each date instead of to each state.</span>
</pre></div>
</div>
</div>
</div>
<p>(<a class="reference internal" href="#pd-bas-dir3"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-4">
<h3>Exercise 4<a class="headerlink" href="#exercise-4" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>For a single state of your choice, determine what the mean
unemployment is during “Low”, “Medium”, and “High” unemployment times
(recall your <code class="docutils literal notranslate"><span class="pre">unemp_bins</span></code> DataFrame from the exercise above).</p>
<ul>
<li><p>Think about how you would do this for all the
states in our sample and write your thoughts… We will soon
learn tools that will <em>greatly</em> simplify operations like
this that operate on distinct <em>groups</em> of data at a time.</p></li>
</ul>
</li>
<li><p>Which states in our sample performs the best during “bad times?” To
determine this, compute the mean unemployment for each state only for
months in which the mean unemployment rate in our sample is greater
than 7.</p></li>
</ul>
<p>(<a class="reference internal" href="#pd-bas-dir4"><span class="std std-ref">back to text</span></a>)</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./pandas"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                    <p>A theme by <a href="https://quantecon.org">QuantEcon</a></p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive persistent" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/index.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/overview.html">
   Course Description
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/getting_started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/cloud_setup.html">
   Cloud Setup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/local_install.html">
   Local Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/troubleshooting.html">
   Troubleshooting
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python Fundamentals
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/index.html">
   Python Fundamentals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/basics.html">
   Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/collections.html">
   Collections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/control_flow.html">
   Control Flow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/functions.html">
   Functions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Scientific Computing
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/index.html">
   Scientific Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/numpy_arrays.html">
   Introduction to Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/plotting.html">
   Plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/applied_linalg.html">
   Applied Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/randomness.html">
   Randomness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/optimization.html">
   Optimization
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Pandas
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   DataFrames and Series in Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   Basic Functionality
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="the_index.html">
   The Index
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="storage_formats.html">
   Storage Formats
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_clean.html">
   Cleaning Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reshape.html">
   Reshape
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="merge.html">
   Merge
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="groupby.html">
   GroupBy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="timeseries.html">
   Time series
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Science Tools
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/index.html">
   Data Science Tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/matplotlib.html">
   Intermediate Plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/maps.html">
   Mapping in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/visualization_rules.html">
   Data Visualization: Rules and Guidelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/regression.html">
   Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/classification.html">
   Classification
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Applications
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/index.html">
   Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/ml_in_economics.html">
   Machine Learning in Economics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/networks.html">
   Social and Economic Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/recidivism.html">
   Case Study: Recidivism
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/working_with_text.html">
   Working with Text
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/heterogeneity.html">
   Heterogeneous Effects
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="../index.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="../search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/pandas/basics.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-datascience.myst/blob/main/lectures/pandas/basics.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-datascience.myst" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-datascience.notebooks/blob/main/pandas/basics.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-datascience.notebooks" data-urlpath="tree/lecture-datascience.notebooks/pandas/basics.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-datascience.notebooks/blob/main/pandas/basics.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "pandas/basics";
                const repoURL = "https://github.com/QuantEcon/lecture-datascience.notebooks";
                const urlPath = "tree/lecture-datascience.notebooks/pandas/basics.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>