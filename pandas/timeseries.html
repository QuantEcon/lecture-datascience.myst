

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Time series &#8212; QuantEcon DataScience</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/quantecon-book-theme.css?digest=bd0785fbb14d8d2bd4d9ae501d79ed8d3bc089ec" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/scripts/quantecon-book-theme.js?digest=d9faaf6c4b57726f74ba012412af1f5681bdff87"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-S8CBQPC844"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-S8CBQPC844');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pandas/timeseries';</script>
    <link rel="canonical" href="https://datascience.quantecon.org/pandas/timeseries.html" />
    <link rel="shortcut icon" href="../_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Science Tools" href="../tools/index.html" />
    <link rel="prev" title="GroupBy" href="groupby.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Chase Coleman, Spencer Lyon, and Jesse Perla" />
<meta name="keywords" content="Python, QuantEcon, DataScience" />
<meta name="description" content=This website presents a series of lectures on programming, data science, and economics. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Time series"/>
<meta name="twitter:description" content="This website presents a series of lectures on programming, data science, and economics.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Time series" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://datascience.quantecon.org/pandas/timeseries.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a series of lectures on programming, data science, and economics." />
<meta property="og:site_name" content="QuantEcon DataScience" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>

<!-- Override QuantEcon theme colors -->

    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=pandas/timeseries>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intro">Intro</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parsing-strings-as-dates">Parsing Strings as Dates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-dates">Multiple Dates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#date-formatting">Date Formatting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-data">Extracting Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-date-properties">Accessing Date Properties</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#leads-and-lags-df-shift">Leads and Lags: <code class="docutils literal notranslate"><span class="pre">df.shift</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rolling-computations-rolling">Rolling Computations: <code class="docutils literal notranslate"><span class="pre">.rolling</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-frequencies-resample">Changing Frequencies: <code class="docutils literal notranslate"><span class="pre">.resample</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-api-keys">Optional: API keys</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">Exercise 8</a></li>
</ul>
</li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="../_static/datascience-logo.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="../index.html">QuantEcon DataScience</a></p>

                        <p class="qe-page__header-subheading">Time series</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">Chase Coleman, Spencer Lyon, and Jesse Perla</p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="time-series">
<h1>Time series<a class="headerlink" href="#time-series" title="Permalink to this heading">#</a></h1>
<p><strong>Co-author</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://www.psolimine.net">Philip Solimine, <em>UBC</em></a></p></li>
</ul>
</div></blockquote>
<p><strong>Prerequisites</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="../python_fundamentals/functions.html"><span class="doc">Python functions</span></a></p></li>
<li><p><a class="reference internal" href="groupby.html"><span class="doc">GroupBy</span></a></p></li>
</ul>
<p><strong>Outcomes</strong></p>
<ul class="simple">
<li><p>Know how pandas handles dates</p></li>
<li><p>Understand how to parse strings into <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects</p></li>
<li><p>Know how to write dates as custom formatted strings</p></li>
<li><p>Be able to access day, month, year, etc. for a <code class="docutils literal notranslate"><span class="pre">DateTimeIndex</span></code> and
a column with <code class="docutils literal notranslate"><span class="pre">dtype</span></code> <code class="docutils literal notranslate"><span class="pre">datetime</span></code></p></li>
<li><p>Understand both rolling and re-sampling operations and the difference
between the two</p></li>
</ul>
<p><strong>Data</strong></p>
<ul class="simple">
<li><p>Bitcoin to USD exchange rates from March 2014 to the present</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment following line to install on colab</span>
<span class="c1">#! pip install </span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="c1"># see section on API keys at end of lecture!</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">nasdaqdatalink</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ndl</span>

<span class="n">ndl</span><span class="o">.</span><span class="n">ApiConfig</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;NASDAQ_DATA_LINK_API_KEY&quot;</span><span class="p">,</span> <span class="s2">&quot;jEKP58z7JaX6utPkkpEp&quot;</span><span class="p">)</span>

<span class="n">start_date</span> <span class="o">=</span> <span class="s2">&quot;2014-05-01&quot;</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<section id="intro">
<h2>Intro<a class="headerlink" href="#intro" title="Permalink to this heading">#</a></h2>
<p>pandas has extensive support for handling dates and times.</p>
<p>We will loosely refer to data with date or time information as time
series data.</p>
<p>In this lecture, we will cover the most useful parts of pandas’ time
series functionality.</p>
<p>Among these topics are:</p>
<ul class="simple">
<li><p>Parsing strings as dates</p></li>
<li><p>Writing <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects as strings (inverse operation of previous point)</p></li>
<li><p>Extracting data from a DataFrame or Series with date information in
the index</p></li>
<li><p>Shifting data through time (taking leads or lags)</p></li>
<li><p>Re-sampling data to a different frequency and rolling operations</p></li>
</ul>
<p>However, even more than with previous topics, we will skip a lot of the
functionality pandas offers, and we urge you to refer to the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/timeseries.html">official
documentation</a>
for more information.</p>
</section>
<section id="parsing-strings-as-dates">
<h2>Parsing Strings as Dates<a class="headerlink" href="#parsing-strings-as-dates" title="Permalink to this heading">#</a></h2>
<p>When working with time series data, we almost always receive the data
with dates encoded as strings.</p>
<p>Hopefully, the date strings follow a structured format or pattern.</p>
<p>One common pattern is <code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span></code>: 4 numbers for the year, 2 for the
month, and 2 for the day with each section separated by a <code class="docutils literal notranslate"><span class="pre">-</span></code>.</p>
<p>For example, we write Christmas day 2017 in this format as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">christmas_str</span> <span class="o">=</span> <span class="s2">&quot;2017-12-25&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>To convert a string into a time-aware object, we use the
<code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">christmas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">christmas_str</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The type of christmas is&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">christmas</span><span class="p">))</span>
<span class="n">christmas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The type of christmas is &lt;class &#39;pandas._libs.tslibs.timestamps.Timestamp&#39;&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2017-12-25 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> function is pretty smart at guessing the format
of the date…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;December 25, 2017&quot;</span><span class="p">,</span> <span class="s2">&quot;Dec. 25, 2017&quot;</span><span class="p">,</span>
             <span class="s2">&quot;Monday, Dec. 25, 2017&quot;</span><span class="p">,</span> <span class="s2">&quot;25 Dec. 2017&quot;</span><span class="p">,</span> <span class="s2">&quot;25th Dec. 2017&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pandas interprets </span><span class="si">{}</span><span class="s2"> as </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">date</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas interprets December 25, 2017 as 2017-12-25 00:00:00
pandas interprets Dec. 25, 2017 as 2017-12-25 00:00:00
pandas interprets Monday, Dec. 25, 2017 as 2017-12-25 00:00:00
pandas interprets 25 Dec. 2017 as 2017-12-25 00:00:00
pandas interprets 25th Dec. 2017 as 2017-12-25 00:00:00
</pre></div>
</div>
</div>
</div>
<p>However, sometimes we will need to give pandas a hint.</p>
<p>For example, that same time (midnight on Christmas) would be reported on
an Amazon transaction report as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">christmas_amzn</span> <span class="o">=</span> <span class="s2">&quot;2017-12-25T00:00:00+ 00 :00&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>If we try to pass this to <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code>, it will fail.</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">christmas_amzn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">DateParseError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">christmas_amzn</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/lecture-datascience/lib/python3.12/site-packages/pandas/core/tools/datetimes.py:1101,</span> in <span class="ni">to_datetime</span><span class="nt">(arg, errors, dayfirst, yearfirst, utc, format, exact, unit, infer_datetime_format, origin, cache)</span>
<span class="g g-Whitespace">   </span><span class="mi">1099</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">convert_listlike</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1100</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1101</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">convert_listlike</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">arg</span><span class="p">]),</span> <span class="nb">format</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1102</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1103</span>         <span class="n">result</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>  <span class="c1"># TODO: avoid this kludge.</span>

<span class="nn">File ~/miniconda3/envs/lecture-datascience/lib/python3.12/site-packages/pandas/core/tools/datetimes.py:435,</span> in <span class="ni">_convert_listlike_datetimes</span><span class="nt">(arg, format, name, utc, unit, errors, dayfirst, yearfirst, exact)</span>
<span class="g g-Whitespace">    </span><span class="mi">432</span> <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">format</span> <span class="o">!=</span> <span class="s2">&quot;mixed&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">433</span>     <span class="k">return</span> <span class="n">_array_strptime_with_fallback</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">utc</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="n">exact</span><span class="p">,</span> <span class="n">errors</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">435</span> <span class="n">result</span><span class="p">,</span> <span class="n">tz_parsed</span> <span class="o">=</span> <span class="n">objects_to_datetime64</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">436</span>     <span class="n">arg</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">437</span>     <span class="n">dayfirst</span><span class="o">=</span><span class="n">dayfirst</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">438</span>     <span class="n">yearfirst</span><span class="o">=</span><span class="n">yearfirst</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span>     <span class="n">utc</span><span class="o">=</span><span class="n">utc</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">440</span>     <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">441</span>     <span class="n">allow_object</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">442</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">444</span> <span class="k">if</span> <span class="n">tz_parsed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">445</span>     <span class="c1"># We can take a shortcut since the datetime64 numpy array</span>
<span class="g g-Whitespace">    </span><span class="mi">446</span>     <span class="c1"># is in UTC</span>
<span class="g g-Whitespace">    </span><span class="mi">447</span>     <span class="n">out_unit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime_data</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">dtype</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="nn">File ~/miniconda3/envs/lecture-datascience/lib/python3.12/site-packages/pandas/core/arrays/datetimes.py:2398,</span> in <span class="ni">objects_to_datetime64</span><span class="nt">(data, dayfirst, yearfirst, utc, errors, allow_object, out_unit)</span>
<span class="g g-Whitespace">   </span><span class="mi">2395</span> <span class="c1"># if str-dtype, convert</span>
<span class="g g-Whitespace">   </span><span class="mi">2396</span> <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">object_</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2398</span> <span class="n">result</span><span class="p">,</span> <span class="n">tz_parsed</span> <span class="o">=</span> <span class="n">tslib</span><span class="o">.</span><span class="n">array_to_datetime</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2399</span>     <span class="n">data</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2400</span>     <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2401</span>     <span class="n">utc</span><span class="o">=</span><span class="n">utc</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2402</span>     <span class="n">dayfirst</span><span class="o">=</span><span class="n">dayfirst</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2403</span>     <span class="n">yearfirst</span><span class="o">=</span><span class="n">yearfirst</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2404</span>     <span class="n">creso</span><span class="o">=</span><span class="n">abbrev_to_npy_unit</span><span class="p">(</span><span class="n">out_unit</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">2405</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2407</span> <span class="k">if</span> <span class="n">tz_parsed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2408</span>     <span class="c1"># We can take a shortcut since the datetime64 numpy array</span>
<span class="g g-Whitespace">   </span><span class="mi">2409</span>     <span class="c1">#  is in UTC</span>
<span class="g g-Whitespace">   </span><span class="mi">2410</span>     <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">tz_parsed</span>

<span class="nn">File tslib.pyx:414,</span> in <span class="ni">pandas._libs.tslib.array_to_datetime</span><span class="nt">()</span>

<span class="nn">File tslib.pyx:596,</span> in <span class="ni">pandas._libs.tslib.array_to_datetime</span><span class="nt">()</span>

<span class="nn">File tslib.pyx:553,</span> in <span class="ni">pandas._libs.tslib.array_to_datetime</span><span class="nt">()</span>

<span class="nn">File conversion.pyx:641,</span> in <span class="ni">pandas._libs.tslibs.conversion.convert_str_to_tsobject</span><span class="nt">()</span>

<span class="nn">File parsing.pyx:336,</span> in <span class="ni">pandas._libs.tslibs.parsing.parse_datetime_string</span><span class="nt">()</span>

<span class="nn">File parsing.pyx:666,</span> in <span class="ni">pandas._libs.tslibs.parsing.dateutil_parse</span><span class="nt">()</span>

<span class="ne">DateParseError</span>: Unknown datetime string format, unable to parse: 2017-12-25T00:00:00+ 00 :00, at position 0
</pre></div>
</div>
</div>
</div>
<p>To parse a date with this format, we need to specify the <code class="docutils literal notranslate"><span class="pre">format</span></code>
argument for <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">amzn_strftime</span> <span class="o">=</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S+ 00 :00&quot;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">christmas_amzn</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">amzn_strftime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2017-12-25 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<p>Can you guess what <code class="docutils literal notranslate"><span class="pre">amzn_strftime</span></code> represents?</p>
<p>Let’s take a closer look at <code class="docutils literal notranslate"><span class="pre">amzn_strftime</span></code> and <code class="docutils literal notranslate"><span class="pre">christmas_amzn</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">amzn_strftime</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">christmas_amzn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>%Y-%m-%dT%H:%M:%S+ 00 :00
2017-12-25T00:00:00+ 00 :00
</pre></div>
</div>
</div>
</div>
<p>Notice that both of the strings have a similar form, but that instead of actual numerical values, <code class="docutils literal notranslate"><span class="pre">amzn_strftime</span></code> has <em>placeholders</em>.</p>
<p>Specifically, anywhere the <code class="docutils literal notranslate"><span class="pre">%</span></code> shows up is a signal to the <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code>
function that it is where relevant information is stored.</p>
<p>For example, the <code class="docutils literal notranslate"><span class="pre">%Y</span></code> is a stand-in for a four digit year, <code class="docutils literal notranslate"><span class="pre">%m</span></code> is
for 2 a digit month, and so on…</p>
<p>The official <a class="reference external" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior">Python
documentation</a> contains a complete list of possible <code class="docutils literal notranslate"><span class="pre">%</span></code>something patterns that are accepted
in the <code class="docutils literal notranslate"><span class="pre">format</span></code> argument.</p>
<div class="admonition-exercise admonition" id="pd-tim-dir1">
<p class="admonition-title">Exercise</p>
<p>See exercise 1 in the <a class="reference internal" href="#pd-tim-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
<section id="multiple-dates">
<h3>Multiple Dates<a class="headerlink" href="#multiple-dates" title="Permalink to this heading">#</a></h3>
<p>If we have dates in a Series (e.g. column of DataFrame) or a list, we
can pass the entire collection to <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> and get a
collection of dates back.</p>
<p>We’ll just show an example of that here as the mechanics are the same as
a single date.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s2">&quot;2017-12-25&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-12-31&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2017-12-25&#39;, &#39;2017-12-31&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="date-formatting">
<h2>Date Formatting<a class="headerlink" href="#date-formatting" title="Permalink to this heading">#</a></h2>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">%</span></code>pattern format to have pandas write <code class="docutils literal notranslate"><span class="pre">datetime</span></code>
objects as specially formatted strings using the <code class="docutils literal notranslate"><span class="pre">strftime</span></code> (string
format time) method.</p>
<p>For example,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">christmas</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;We love %A %B </span><span class="si">%d</span><span class="s2"> (also written </span><span class="si">%c</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;We love Monday December 25 (also written Mon Dec 25 00:00:00 2017)&#39;
</pre></div>
</div>
</div>
</div>
<div class="admonition-exercise admonition" id="pd-tim-dir2">
<p class="admonition-title">Exercise</p>
<p>See exercise 2 in the <a class="reference internal" href="#pd-tim-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
</section>
<section id="extracting-data">
<h2>Extracting Data<a class="headerlink" href="#extracting-data" title="Permalink to this heading">#</a></h2>
<p>When the index of a DataFrame has date information and pandas
recognizes the values as <code class="docutils literal notranslate"><span class="pre">datetime</span></code> values, we can leverage some
convenient indexing features for extracting data.</p>
<p>The flexibility of these features is best understood through example,
so let’s load up some data and take a look.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_usd_long</span> <span class="o">=</span> <span class="n">ndl</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="s2">&quot;QDL/BCHAIN&quot;</span><span class="p">,</span> <span class="n">date</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;gte&#39;</span><span class="p">:</span> <span class="s1">&#39;2009-12-25&#39;</span><span class="p">,</span> <span class="s1">&#39;lte&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-01-01&#39;</span> <span class="p">},</span> <span class="n">code</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MKPRU&quot;</span><span class="p">,</span> <span class="s2">&quot;MKTCP&quot;</span><span class="p">,</span> <span class="s2">&quot;ETRVU&quot;</span><span class="p">])</span>
<span class="n">btc_usd_long</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">btc_usd_long</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 9885 entries, 0 to 9884
Data columns (total 3 columns):
 #   Column  Non-Null Count  Dtype         
---  ------  --------------  -----         
 0   code    9885 non-null   object        
 1   date    9885 non-null   datetime64[ns]
 2   value   9885 non-null   float64       
dtypes: datetime64[ns](1), float64(1), object(1)
memory usage: 231.8+ KB
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>date</th>
      <th>value</th>
    </tr>
    <tr>
      <th>None</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>MKTCP</td>
      <td>2019-01-01</td>
      <td>6.550566e+10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MKTCP</td>
      <td>2018-12-31</td>
      <td>6.638886e+10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>MKTCP</td>
      <td>2018-12-30</td>
      <td>6.689905e+10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>MKTCP</td>
      <td>2018-12-29</td>
      <td>6.827565e+10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>MKTCP</td>
      <td>2018-12-28</td>
      <td>6.709189e+10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here, we have the Bitcoin (BTC) to US dollar (USD) exchange rate from
2009 until today, as well as other variables relevant to the Bitcoin ecosystem, in long (“melted”) form.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">btc_usd_long</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">btc_usd_long</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;MKTCP&#39; &#39;MKPRU&#39; &#39;ETRVU&#39;]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>code             object
date     datetime64[ns]
value           float64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Notice that the type of <code class="docutils literal notranslate"><span class="pre">date</span></code> is <code class="docutils literal notranslate"><span class="pre">datetime</span></code>. We would like this to be the index, and we want to drop the long form. We also selected only a couple of columns of interest, but the dataset has a lot more options. (The column descriptions can be found <a class="reference external" href="https://data.nasdaq.com/databases/BCHAIN">here</a>). We chose Market Price (in USD) (<code class="docutils literal notranslate"><span class="pre">MKPRU</span></code>), Total Market Cap (<code class="docutils literal notranslate"><span class="pre">MKTCP</span></code>), and Estimated Transaction Volume in USD (<code class="docutils literal notranslate"><span class="pre">ETRVU</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_usd</span> <span class="o">=</span> <span class="n">btc_usd_long</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">btc_usd</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-12-25</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-26</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-27</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-28</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-29</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now that we have a datetime index, it enables things like…</p>
<p>Extracting all data for the year 2015 by passing <code class="docutils literal notranslate"><span class="pre">&quot;2015&quot;</span></code> to <code class="docutils literal notranslate"><span class="pre">.loc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_usd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2015&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-01-01</th>
      <td>2.831524e+07</td>
      <td>316.15</td>
      <td>4.388454e+09</td>
    </tr>
    <tr>
      <th>2015-01-02</th>
      <td>5.458287e+07</td>
      <td>314.81</td>
      <td>4.136728e+09</td>
    </tr>
    <tr>
      <th>2015-01-03</th>
      <td>9.035606e+07</td>
      <td>270.93</td>
      <td>3.708212e+09</td>
    </tr>
    <tr>
      <th>2015-01-04</th>
      <td>6.263383e+07</td>
      <td>276.80</td>
      <td>3.901250e+09</td>
    </tr>
    <tr>
      <th>2015-01-05</th>
      <td>5.647246e+07</td>
      <td>263.17</td>
      <td>3.790804e+09</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2015-12-27</th>
      <td>7.700877e+07</td>
      <td>418.46</td>
      <td>6.420190e+09</td>
    </tr>
    <tr>
      <th>2015-12-28</th>
      <td>1.057652e+08</td>
      <td>422.42</td>
      <td>6.366855e+09</td>
    </tr>
    <tr>
      <th>2015-12-29</th>
      <td>1.158679e+08</td>
      <td>431.13</td>
      <td>6.475864e+09</td>
    </tr>
    <tr>
      <th>2015-12-30</th>
      <td>9.992696e+07</td>
      <td>428.00</td>
      <td>6.386794e+09</td>
    </tr>
    <tr>
      <th>2015-12-31</th>
      <td>7.566080e+07</td>
      <td>428.23</td>
      <td>6.452379e+09</td>
    </tr>
  </tbody>
</table>
<p>365 rows × 3 columns</p>
</div></div></div>
</div>
<p>We can also narrow down to specific months.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># By month&#39;s name</span>
<span class="n">btc_usd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;August 2017&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-08-01</th>
      <td>1.369196e+09</td>
      <td>2862.9000</td>
      <td>4.550093e+10</td>
    </tr>
    <tr>
      <th>2017-08-02</th>
      <td>1.424506e+09</td>
      <td>2693.6340</td>
      <td>4.440385e+10</td>
    </tr>
    <tr>
      <th>2017-08-03</th>
      <td>9.709563e+08</td>
      <td>2794.1177</td>
      <td>4.606512e+10</td>
    </tr>
    <tr>
      <th>2017-08-04</th>
      <td>1.196485e+09</td>
      <td>2790.0000</td>
      <td>4.631086e+10</td>
    </tr>
    <tr>
      <th>2017-08-05</th>
      <td>9.791541e+08</td>
      <td>3218.1150</td>
      <td>5.306965e+10</td>
    </tr>
    <tr>
      <th>2017-08-06</th>
      <td>1.044204e+09</td>
      <td>3252.5625</td>
      <td>5.364342e+10</td>
    </tr>
    <tr>
      <th>2017-08-07</th>
      <td>1.385571e+09</td>
      <td>3210.2000</td>
      <td>5.319216e+10</td>
    </tr>
    <tr>
      <th>2017-08-08</th>
      <td>1.230026e+09</td>
      <td>3457.3743</td>
      <td>5.703501e+10</td>
    </tr>
    <tr>
      <th>2017-08-09</th>
      <td>8.071196e+08</td>
      <td>3357.3263</td>
      <td>5.526816e+10</td>
    </tr>
    <tr>
      <th>2017-08-10</th>
      <td>9.631284e+08</td>
      <td>3340.2800</td>
      <td>5.650275e+10</td>
    </tr>
    <tr>
      <th>2017-08-11</th>
      <td>9.856015e+08</td>
      <td>3632.5067</td>
      <td>5.994299e+10</td>
    </tr>
    <tr>
      <th>2017-08-12</th>
      <td>8.706294e+08</td>
      <td>3852.8029</td>
      <td>6.358478e+10</td>
    </tr>
    <tr>
      <th>2017-08-13</th>
      <td>9.264450e+08</td>
      <td>3868.5200</td>
      <td>6.693611e+10</td>
    </tr>
    <tr>
      <th>2017-08-14</th>
      <td>8.666749e+08</td>
      <td>4282.9920</td>
      <td>7.069930e+10</td>
    </tr>
    <tr>
      <th>2017-08-15</th>
      <td>1.206088e+09</td>
      <td>4217.0283</td>
      <td>6.961845e+10</td>
    </tr>
    <tr>
      <th>2017-08-16</th>
      <td>9.825228e+08</td>
      <td>4179.9700</td>
      <td>6.764231e+10</td>
    </tr>
    <tr>
      <th>2017-08-17</th>
      <td>1.362841e+09</td>
      <td>4328.7257</td>
      <td>7.147917e+10</td>
    </tr>
    <tr>
      <th>2017-08-18</th>
      <td>1.137242e+09</td>
      <td>4130.4401</td>
      <td>6.821262e+10</td>
    </tr>
    <tr>
      <th>2017-08-19</th>
      <td>1.323689e+09</td>
      <td>4104.7100</td>
      <td>6.812422e+10</td>
    </tr>
    <tr>
      <th>2017-08-20</th>
      <td>7.589911e+08</td>
      <td>4157.9580</td>
      <td>6.868167e+10</td>
    </tr>
    <tr>
      <th>2017-08-21</th>
      <td>8.194572e+08</td>
      <td>4043.7220</td>
      <td>6.680052e+10</td>
    </tr>
    <tr>
      <th>2017-08-22</th>
      <td>8.814776e+08</td>
      <td>3986.2800</td>
      <td>6.755553e+10</td>
    </tr>
    <tr>
      <th>2017-08-23</th>
      <td>1.053264e+09</td>
      <td>4174.9500</td>
      <td>6.898129e+10</td>
    </tr>
    <tr>
      <th>2017-08-24</th>
      <td>7.560436e+08</td>
      <td>4340.3167</td>
      <td>7.171907e+10</td>
    </tr>
    <tr>
      <th>2017-08-25</th>
      <td>7.651743e+08</td>
      <td>4331.7700</td>
      <td>7.210029e+10</td>
    </tr>
    <tr>
      <th>2017-08-26</th>
      <td>6.879348e+08</td>
      <td>4360.5133</td>
      <td>7.067509e+10</td>
    </tr>
    <tr>
      <th>2017-08-27</th>
      <td>7.814597e+08</td>
      <td>4354.3083</td>
      <td>7.196991e+10</td>
    </tr>
    <tr>
      <th>2017-08-28</th>
      <td>9.251545e+08</td>
      <td>4339.0500</td>
      <td>7.259458e+10</td>
    </tr>
    <tr>
      <th>2017-08-29</th>
      <td>1.113344e+09</td>
      <td>4607.9854</td>
      <td>7.593083e+10</td>
    </tr>
    <tr>
      <th>2017-08-30</th>
      <td>1.010876e+09</td>
      <td>4594.9879</td>
      <td>7.597359e+10</td>
    </tr>
    <tr>
      <th>2017-08-31</th>
      <td>1.192190e+09</td>
      <td>4582.5200</td>
      <td>7.851738e+10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># By month&#39;s number</span>
<span class="n">btc_usd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;08/2017&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-08-01</th>
      <td>1.369196e+09</td>
      <td>2862.9000</td>
      <td>4.550093e+10</td>
    </tr>
    <tr>
      <th>2017-08-02</th>
      <td>1.424506e+09</td>
      <td>2693.6340</td>
      <td>4.440385e+10</td>
    </tr>
    <tr>
      <th>2017-08-03</th>
      <td>9.709563e+08</td>
      <td>2794.1177</td>
      <td>4.606512e+10</td>
    </tr>
    <tr>
      <th>2017-08-04</th>
      <td>1.196485e+09</td>
      <td>2790.0000</td>
      <td>4.631086e+10</td>
    </tr>
    <tr>
      <th>2017-08-05</th>
      <td>9.791541e+08</td>
      <td>3218.1150</td>
      <td>5.306965e+10</td>
    </tr>
    <tr>
      <th>2017-08-06</th>
      <td>1.044204e+09</td>
      <td>3252.5625</td>
      <td>5.364342e+10</td>
    </tr>
    <tr>
      <th>2017-08-07</th>
      <td>1.385571e+09</td>
      <td>3210.2000</td>
      <td>5.319216e+10</td>
    </tr>
    <tr>
      <th>2017-08-08</th>
      <td>1.230026e+09</td>
      <td>3457.3743</td>
      <td>5.703501e+10</td>
    </tr>
    <tr>
      <th>2017-08-09</th>
      <td>8.071196e+08</td>
      <td>3357.3263</td>
      <td>5.526816e+10</td>
    </tr>
    <tr>
      <th>2017-08-10</th>
      <td>9.631284e+08</td>
      <td>3340.2800</td>
      <td>5.650275e+10</td>
    </tr>
    <tr>
      <th>2017-08-11</th>
      <td>9.856015e+08</td>
      <td>3632.5067</td>
      <td>5.994299e+10</td>
    </tr>
    <tr>
      <th>2017-08-12</th>
      <td>8.706294e+08</td>
      <td>3852.8029</td>
      <td>6.358478e+10</td>
    </tr>
    <tr>
      <th>2017-08-13</th>
      <td>9.264450e+08</td>
      <td>3868.5200</td>
      <td>6.693611e+10</td>
    </tr>
    <tr>
      <th>2017-08-14</th>
      <td>8.666749e+08</td>
      <td>4282.9920</td>
      <td>7.069930e+10</td>
    </tr>
    <tr>
      <th>2017-08-15</th>
      <td>1.206088e+09</td>
      <td>4217.0283</td>
      <td>6.961845e+10</td>
    </tr>
    <tr>
      <th>2017-08-16</th>
      <td>9.825228e+08</td>
      <td>4179.9700</td>
      <td>6.764231e+10</td>
    </tr>
    <tr>
      <th>2017-08-17</th>
      <td>1.362841e+09</td>
      <td>4328.7257</td>
      <td>7.147917e+10</td>
    </tr>
    <tr>
      <th>2017-08-18</th>
      <td>1.137242e+09</td>
      <td>4130.4401</td>
      <td>6.821262e+10</td>
    </tr>
    <tr>
      <th>2017-08-19</th>
      <td>1.323689e+09</td>
      <td>4104.7100</td>
      <td>6.812422e+10</td>
    </tr>
    <tr>
      <th>2017-08-20</th>
      <td>7.589911e+08</td>
      <td>4157.9580</td>
      <td>6.868167e+10</td>
    </tr>
    <tr>
      <th>2017-08-21</th>
      <td>8.194572e+08</td>
      <td>4043.7220</td>
      <td>6.680052e+10</td>
    </tr>
    <tr>
      <th>2017-08-22</th>
      <td>8.814776e+08</td>
      <td>3986.2800</td>
      <td>6.755553e+10</td>
    </tr>
    <tr>
      <th>2017-08-23</th>
      <td>1.053264e+09</td>
      <td>4174.9500</td>
      <td>6.898129e+10</td>
    </tr>
    <tr>
      <th>2017-08-24</th>
      <td>7.560436e+08</td>
      <td>4340.3167</td>
      <td>7.171907e+10</td>
    </tr>
    <tr>
      <th>2017-08-25</th>
      <td>7.651743e+08</td>
      <td>4331.7700</td>
      <td>7.210029e+10</td>
    </tr>
    <tr>
      <th>2017-08-26</th>
      <td>6.879348e+08</td>
      <td>4360.5133</td>
      <td>7.067509e+10</td>
    </tr>
    <tr>
      <th>2017-08-27</th>
      <td>7.814597e+08</td>
      <td>4354.3083</td>
      <td>7.196991e+10</td>
    </tr>
    <tr>
      <th>2017-08-28</th>
      <td>9.251545e+08</td>
      <td>4339.0500</td>
      <td>7.259458e+10</td>
    </tr>
    <tr>
      <th>2017-08-29</th>
      <td>1.113344e+09</td>
      <td>4607.9854</td>
      <td>7.593083e+10</td>
    </tr>
    <tr>
      <th>2017-08-30</th>
      <td>1.010876e+09</td>
      <td>4594.9879</td>
      <td>7.597359e+10</td>
    </tr>
    <tr>
      <th>2017-08-31</th>
      <td>1.192190e+09</td>
      <td>4582.5200</td>
      <td>7.851738e+10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Or even a day…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># By date name</span>
<span class="n">btc_usd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;August 1, 2017&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>code
ETRVU    1.369196e+09
MKPRU    2.862900e+03
MKTCP    4.550093e+10
Name: 2017-08-01 00:00:00, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># By date number</span>
<span class="n">btc_usd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;08-01-2017&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>code
ETRVU    1.369196e+09
MKPRU    2.862900e+03
MKTCP    4.550093e+10
Name: 2017-08-01 00:00:00, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>What can we pass as the <code class="docutils literal notranslate"><span class="pre">.loc</span></code> argument when we have a
<code class="docutils literal notranslate"><span class="pre">DateTimeIndex</span></code>?</p>
<p>Anything that can be converted to a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> using
<code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code>, <em>without</em> having to specify the format argument.</p>
<p>When that condition holds, pandas will return <em>all</em> rows whose date in
the index “belong” to that date or period.</p>
<p>We can also use the range shorthand notation to give a start and end
date for selection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_usd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;April 1, 2015&quot;</span><span class="p">:</span><span class="s2">&quot;April 10, 2015&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-04-01</th>
      <td>5.354486e+07</td>
      <td>252.44</td>
      <td>3.536773e+09</td>
    </tr>
    <tr>
      <th>2015-04-02</th>
      <td>4.016409e+07</td>
      <td>246.49</td>
      <td>3.565053e+09</td>
    </tr>
    <tr>
      <th>2015-04-03</th>
      <td>4.331351e+07</td>
      <td>253.77</td>
      <td>3.549561e+09</td>
    </tr>
    <tr>
      <th>2015-04-04</th>
      <td>2.205524e+07</td>
      <td>257.03</td>
      <td>3.604010e+09</td>
    </tr>
    <tr>
      <th>2015-04-05</th>
      <td>2.832354e+07</td>
      <td>253.67</td>
      <td>3.572161e+09</td>
    </tr>
    <tr>
      <th>2015-04-06</th>
      <td>3.991755e+07</td>
      <td>255.48</td>
      <td>3.584116e+09</td>
    </tr>
    <tr>
      <th>2015-04-07</th>
      <td>5.134161e+07</td>
      <td>245.89</td>
      <td>3.579212e+09</td>
    </tr>
    <tr>
      <th>2015-04-08</th>
      <td>5.092222e+07</td>
      <td>253.90</td>
      <td>3.438417e+09</td>
    </tr>
    <tr>
      <th>2015-04-09</th>
      <td>5.215728e+07</td>
      <td>235.71</td>
      <td>3.309144e+09</td>
    </tr>
    <tr>
      <th>2015-04-10</th>
      <td>4.316281e+07</td>
      <td>236.70</td>
      <td>3.411246e+09</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition-exercise admonition" id="pd-tim-dir3">
<p class="admonition-title">Exercise</p>
<p>See exercise 3 in the <a class="reference internal" href="#pd-tim-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
</section>
<section id="accessing-date-properties">
<h2>Accessing Date Properties<a class="headerlink" href="#accessing-date-properties" title="Permalink to this heading">#</a></h2>
<p>Sometimes, we would like to directly access a part of the date/time.</p>
<p>If our date/time information is in the index, we can to <code class="docutils literal notranslate"><span class="pre">df.index.XX</span></code>
where <code class="docutils literal notranslate"><span class="pre">XX</span></code> is replaced by <code class="docutils literal notranslate"><span class="pre">year</span></code>, <code class="docutils literal notranslate"><span class="pre">month</span></code>, or whatever we would
like to access.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_usd</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([2009, 2009, 2009, 2009, 2009, 2009, 2009, 2010, 2010, 2010,
       ...
       2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2019],
      dtype=&#39;int32&#39;, name=&#39;date&#39;, length=3295)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_usd</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([25, 26, 27, 28, 29, 30, 31,  1,  2,  3,
       ...
       23, 24, 25, 26, 27, 28, 29, 30, 31,  1],
      dtype=&#39;int32&#39;, name=&#39;date&#39;, length=3295)
</pre></div>
</div>
</div>
</div>
<p>We can also do the same if the date/time information is stored in a
column, but we have to use a slightly different syntax.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;column_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">XX</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_date_column</span> <span class="o">=</span> <span class="n">btc_usd</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">btc_date_column</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>date</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2009-12-25</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2009-12-26</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2009-12-27</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2009-12-28</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2009-12-29</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_date_column</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2009
1    2009
2    2009
3    2009
4    2009
Name: date, dtype: int32
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_date_column</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    12
1    12
2    12
3    12
4    12
Name: date, dtype: int32
</pre></div>
</div>
</div>
</div>
</section>
<section id="leads-and-lags-df-shift">
<h2>Leads and Lags: <code class="docutils literal notranslate"><span class="pre">df.shift</span></code><a class="headerlink" href="#leads-and-lags-df-shift" title="Permalink to this heading">#</a></h2>
<p>When doing time series analysis, we often want to compare data at one
date against data at another date.</p>
<p>pandas can help us with this if we leverage the <code class="docutils literal notranslate"><span class="pre">shift</span></code> method.</p>
<p>Without any additional arguments, <code class="docutils literal notranslate"><span class="pre">shift()</span></code> will move all data
<em>forward</em> one period, filling the first row with missing data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># so we can see the result of shift clearly</span>
<span class="n">btc_usd</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-12-25</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-26</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-27</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-28</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-29</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_usd</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-12-25</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-12-26</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-27</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-28</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-29</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can use this to compute the percent change from one day to the next.
(Quiz: Why does that work? Remember how pandas uses the index to <em>align</em>
data.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">btc_usd</span> <span class="o">-</span> <span class="n">btc_usd</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span> <span class="o">/</span> <span class="n">btc_usd</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-12-25</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-12-26</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-12-27</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-12-28</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-12-29</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Setting the first argument to <code class="docutils literal notranslate"><span class="pre">n</span></code> tells pandas to shift the data down
<code class="docutils literal notranslate"><span class="pre">n</span></code> rows (apply an <code class="docutils literal notranslate"><span class="pre">n</span></code> period lag).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_usd</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-12-25</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-12-26</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-12-27</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-12-28</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-29</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A negative value will shift the data <em>up</em> or apply a lead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_usd</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-12-25</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-26</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-27</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-28</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-29</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_usd</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-12-28</th>
      <td>2.700024e+08</td>
      <td>3770.3600</td>
      <td>6.689905e+10</td>
    </tr>
    <tr>
      <th>2018-12-29</th>
      <td>4.760031e+08</td>
      <td>3791.5458</td>
      <td>6.638886e+10</td>
    </tr>
    <tr>
      <th>2018-12-30</th>
      <td>2.236265e+08</td>
      <td>3752.2717</td>
      <td>6.550566e+10</td>
    </tr>
    <tr>
      <th>2018-12-31</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2019-01-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition-exercise admonition" id="pd-tim-dir4">
<p class="admonition-title">Exercise</p>
<p>See exercise 4 in the <a class="reference internal" href="#pd-tim-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
</section>
<section id="rolling-computations-rolling">
<h2>Rolling Computations: <code class="docutils literal notranslate"><span class="pre">.rolling</span></code><a class="headerlink" href="#rolling-computations-rolling" title="Permalink to this heading">#</a></h2>
<p>pandas has facilities that enable easy computation of <em>rolling
statistics</em>.</p>
<p>These are best understood by example, so we will dive right in.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first take only the first 6 rows so we can easily see what is going on</span>
<span class="n">btc_small</span> <span class="o">=</span> <span class="n">btc_usd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">btc_small</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-12-25</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-26</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-27</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-28</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-29</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-30</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Below, we compute the 2 day moving average (for all columns).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_small</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="s2">&quot;2d&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-12-25</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-26</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-27</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-28</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-29</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-30</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To do this operation, pandas starts at each row (date) then looks
<em>backwards</em> the specified number of periods (here 2 days) and then
applies some aggregation function (<code class="docutils literal notranslate"><span class="pre">mean</span></code>) on all the data in that
window.</p>
<p>If pandas cannot look back the full length of the window (e.g. when
working on the first row), it fills as much of the window as possible
and then does the operation. Notice that the value at 2014-05-01 is
the same in both DataFrames.</p>
<p>Below, we see a visual depiction of the rolling maximum on a 21 day
window for the whole dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">btc_usd</span><span class="p">[</span><span class="s2">&quot;MKPRU&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">btc_usd</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="s2">&quot;21d&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()[</span><span class="s2">&quot;MKPRU&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Original&quot;</span><span class="p">,</span> <span class="s2">&quot;21 day max&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f55fa724ef0&gt;
</pre></div>
</div>
<img alt="../_images/bc76cd5cda54b57de082dac9ea06a13a23d59b9acae6a369de633014d21a4536.png" src="../_images/bc76cd5cda54b57de082dac9ea06a13a23d59b9acae6a369de633014d21a4536.png" />
</div>
</div>
<p>We can also ask pandas to <code class="docutils literal notranslate"><span class="pre">apply</span></code> custom functions, similar to what we
saw when studying GroupBy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">is_volatile</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="s2">&quot;Returns a 1 if the variance is greater than 1, otherwise returns 0&quot;</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">1.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc_small</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="s2">&quot;2d&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_volatile</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-12-25</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-26</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-27</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-28</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-29</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-12-30</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition-exercise admonition" id="pd-tim-dir5">
<p class="admonition-title">Exercise</p>
<p>See exercise 5 in the <a class="reference internal" href="#pd-tim-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
<p>To make the optimal decision, we need to know the maximum
difference between the close price at the end of the window and the open
price at the start of the window.</p>
<div class="admonition-exercise admonition" id="pd-tim-dir6">
<p class="admonition-title">Exercise</p>
<p>See exercise 6 in the <a class="reference internal" href="#pd-tim-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
</section>
<section id="changing-frequencies-resample">
<h2>Changing Frequencies: <code class="docutils literal notranslate"><span class="pre">.resample</span></code><a class="headerlink" href="#changing-frequencies-resample" title="Permalink to this heading">#</a></h2>
<p>In addition to computing rolling statistics, we can also change the
frequency of the data.</p>
<p>For example, instead of a monthly moving average, suppose that we wanted
to compute the average <em>within</em> each calendar month.</p>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">resample</span></code> method to do this.</p>
<p>Below are some examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># business quarter</span>
<span class="n">btc_usd</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;BQE&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>code</th>
      <th>ETRVU</th>
      <th>MKPRU</th>
      <th>MKTCP</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-12-31</th>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2010-03-31</th>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2010-06-30</th>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2010-09-30</th>
      <td>8.522276e+02</td>
      <td>0.033260</td>
      <td>1.317223e+05</td>
    </tr>
    <tr>
      <th>2010-12-31</th>
      <td>1.179063e+04</td>
      <td>0.217938</td>
      <td>1.015812e+06</td>
    </tr>
    <tr>
      <th>2011-03-31</th>
      <td>4.516475e+04</td>
      <td>0.737402</td>
      <td>4.043357e+06</td>
    </tr>
    <tr>
      <th>2011-06-30</th>
      <td>1.729951e+06</td>
      <td>9.176310</td>
      <td>5.956523e+07</td>
    </tr>
    <tr>
      <th>2011-09-30</th>
      <td>9.176091e+05</td>
      <td>10.742849</td>
      <td>7.522893e+07</td>
    </tr>
    <tr>
      <th>2011-12-30</th>
      <td>1.991838e+06</td>
      <td>3.419525</td>
      <td>2.639635e+07</td>
    </tr>
    <tr>
      <th>2012-03-30</th>
      <td>7.588531e+05</td>
      <td>5.592202</td>
      <td>4.670274e+07</td>
    </tr>
    <tr>
      <th>2012-06-29</th>
      <td>1.101213e+06</td>
      <td>5.407497</td>
      <td>4.886157e+07</td>
    </tr>
    <tr>
      <th>2012-09-28</th>
      <td>2.821250e+06</td>
      <td>10.356359</td>
      <td>1.007798e+08</td>
    </tr>
    <tr>
      <th>2012-12-31</th>
      <td>2.701674e+06</td>
      <td>12.368074</td>
      <td>1.286258e+08</td>
    </tr>
    <tr>
      <th>2013-03-29</th>
      <td>8.611094e+06</td>
      <td>32.621256</td>
      <td>3.515062e+08</td>
    </tr>
    <tr>
      <th>2013-06-28</th>
      <td>2.782766e+07</td>
      <td>119.419551</td>
      <td>1.337195e+09</td>
    </tr>
    <tr>
      <th>2013-09-30</th>
      <td>1.979282e+07</td>
      <td>107.674014</td>
      <td>1.242022e+09</td>
    </tr>
    <tr>
      <th>2013-12-31</th>
      <td>1.081436e+08</td>
      <td>494.289457</td>
      <td>6.009161e+09</td>
    </tr>
    <tr>
      <th>2014-03-31</th>
      <td>9.001297e+07</td>
      <td>693.245444</td>
      <td>8.591035e+09</td>
    </tr>
    <tr>
      <th>2014-06-30</th>
      <td>5.479866e+07</td>
      <td>520.799451</td>
      <td>6.665094e+09</td>
    </tr>
    <tr>
      <th>2014-09-30</th>
      <td>5.296835e+07</td>
      <td>534.162283</td>
      <td>7.020311e+09</td>
    </tr>
    <tr>
      <th>2014-12-31</th>
      <td>6.272862e+07</td>
      <td>357.784674</td>
      <td>4.835176e+09</td>
    </tr>
    <tr>
      <th>2015-03-31</th>
      <td>5.113746e+07</td>
      <td>250.173111</td>
      <td>3.481522e+09</td>
    </tr>
    <tr>
      <th>2015-06-30</th>
      <td>4.752748e+07</td>
      <td>236.218681</td>
      <td>3.355567e+09</td>
    </tr>
    <tr>
      <th>2015-09-30</th>
      <td>6.545561e+07</td>
      <td>255.963913</td>
      <td>3.712326e+09</td>
    </tr>
    <tr>
      <th>2015-12-31</th>
      <td>1.385931e+08</td>
      <td>345.638152</td>
      <td>5.142968e+09</td>
    </tr>
    <tr>
      <th>2016-03-31</th>
      <td>1.283647e+08</td>
      <td>409.983516</td>
      <td>6.226075e+09</td>
    </tr>
    <tr>
      <th>2016-06-30</th>
      <td>1.665296e+08</td>
      <td>510.586051</td>
      <td>7.972975e+09</td>
    </tr>
    <tr>
      <th>2016-09-30</th>
      <td>1.499507e+08</td>
      <td>615.694674</td>
      <td>9.752593e+09</td>
    </tr>
    <tr>
      <th>2016-12-30</th>
      <td>1.928515e+08</td>
      <td>724.429451</td>
      <td>1.163821e+10</td>
    </tr>
    <tr>
      <th>2017-03-31</th>
      <td>2.747348e+08</td>
      <td>1033.310616</td>
      <td>1.667005e+10</td>
    </tr>
    <tr>
      <th>2017-06-30</th>
      <td>5.764680e+08</td>
      <td>1900.426105</td>
      <td>3.122785e+10</td>
    </tr>
    <tr>
      <th>2017-09-29</th>
      <td>8.735033e+08</td>
      <td>3461.377390</td>
      <td>5.764089e+10</td>
    </tr>
    <tr>
      <th>2017-12-29</th>
      <td>2.332756e+09</td>
      <td>9258.879054</td>
      <td>1.552192e+11</td>
    </tr>
    <tr>
      <th>2018-03-30</th>
      <td>1.906414e+09</td>
      <td>10664.432624</td>
      <td>1.792487e+11</td>
    </tr>
    <tr>
      <th>2018-06-29</th>
      <td>9.201284e+08</td>
      <td>7787.273765</td>
      <td>1.320632e+11</td>
    </tr>
    <tr>
      <th>2018-09-28</th>
      <td>7.135467e+08</td>
      <td>6797.888576</td>
      <td>1.170264e+11</td>
    </tr>
    <tr>
      <th>2018-12-31</th>
      <td>7.343926e+08</td>
      <td>5248.198650</td>
      <td>9.075620e+10</td>
    </tr>
    <tr>
      <th>2019-03-29</th>
      <td>2.236265e+08</td>
      <td>3752.271700</td>
      <td>6.550566e+10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that unlike with <code class="docutils literal notranslate"><span class="pre">rolling</span></code>, a single number is returned for
each column for each quarter.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">resample</span></code> method will alter the frequency of the data and the
number of rows in the result will be different from the number of rows
in the input.</p>
<p>On the other hand, with <code class="docutils literal notranslate"><span class="pre">rolling</span></code>, the size and frequency of the result
are the same as the input.</p>
<p>We can sample at other frequencies and aggregate with multiple aggregations
function at once.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># multiple functions at 2 start-of-quarter frequency</span>
<span class="n">btc_usd</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;2BQS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>code</th>
      <th colspan="2" halign="left">ETRVU</th>
      <th colspan="2" halign="left">MKPRU</th>
      <th colspan="2" halign="left">MKTCP</th>
    </tr>
    <tr>
      <th></th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-10-01</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2010-04-01</th>
      <td>0.000000e+00</td>
      <td>4.780000e+03</td>
      <td>0.0000</td>
      <td>0.1750</td>
      <td>0.000000e+00</td>
      <td>6.992825e+05</td>
    </tr>
    <tr>
      <th>2010-10-01</th>
      <td>1.649000e+03</td>
      <td>2.441970e+05</td>
      <td>0.0600</td>
      <td>1.1000</td>
      <td>2.493210e+05</td>
      <td>5.901940e+06</td>
    </tr>
    <tr>
      <th>2011-04-01</th>
      <td>2.740300e+04</td>
      <td>1.815384e+07</td>
      <td>0.7100</td>
      <td>35.0000</td>
      <td>4.150234e+06</td>
      <td>2.272585e+08</td>
    </tr>
    <tr>
      <th>2011-10-03</th>
      <td>1.975250e+05</td>
      <td>1.637516e+07</td>
      <td>2.2900</td>
      <td>7.2200</td>
      <td>1.766128e+07</td>
      <td>5.811768e+07</td>
    </tr>
    <tr>
      <th>2012-04-02</th>
      <td>4.122260e+05</td>
      <td>1.322970e+07</td>
      <td>4.8000</td>
      <td>15.4000</td>
      <td>4.195824e+07</td>
      <td>1.496572e+08</td>
    </tr>
    <tr>
      <th>2012-10-01</th>
      <td>7.742860e+05</td>
      <td>2.769433e+07</td>
      <td>10.6010</td>
      <td>93.5670</td>
      <td>1.093527e+08</td>
      <td>1.125488e+09</td>
    </tr>
    <tr>
      <th>2013-04-01</th>
      <td>9.821585e+06</td>
      <td>1.385370e+08</td>
      <td>67.8584</td>
      <td>237.9900</td>
      <td>7.519925e+08</td>
      <td>2.620841e+09</td>
    </tr>
    <tr>
      <th>2013-10-01</th>
      <td>1.150644e+07</td>
      <td>3.843574e+08</td>
      <td>103.8500</td>
      <td>1151.0000</td>
      <td>1.230957e+09</td>
      <td>1.350490e+10</td>
    </tr>
    <tr>
      <th>2014-04-01</th>
      <td>1.976148e+07</td>
      <td>1.765106e+08</td>
      <td>380.0000</td>
      <td>673.9000</td>
      <td>4.661392e+09</td>
      <td>8.668279e+09</td>
    </tr>
    <tr>
      <th>2014-10-01</th>
      <td>2.502690e+07</td>
      <td>1.781682e+08</td>
      <td>176.5000</td>
      <td>430.0700</td>
      <td>2.707305e+09</td>
      <td>5.802913e+09</td>
    </tr>
    <tr>
      <th>2015-04-01</th>
      <td>2.205524e+07</td>
      <td>1.056422e+08</td>
      <td>216.0000</td>
      <td>310.5500</td>
      <td>3.077795e+09</td>
      <td>4.464575e+09</td>
    </tr>
    <tr>
      <th>2015-10-01</th>
      <td>4.002130e+07</td>
      <td>3.353970e+08</td>
      <td>237.7800</td>
      <td>463.9800</td>
      <td>3.486830e+09</td>
      <td>6.952138e+09</td>
    </tr>
    <tr>
      <th>2016-04-01</th>
      <td>7.246670e+07</td>
      <td>4.338279e+08</td>
      <td>416.2500</td>
      <td>754.3600</td>
      <td>6.402758e+09</td>
      <td>1.212991e+10</td>
    </tr>
    <tr>
      <th>2016-10-03</th>
      <td>1.006182e+08</td>
      <td>5.526767e+08</td>
      <td>607.1800</td>
      <td>1287.0000</td>
      <td>9.676305e+09</td>
      <td>2.089075e+10</td>
    </tr>
    <tr>
      <th>2017-04-03</th>
      <td>1.955462e+08</td>
      <td>1.772644e+09</td>
      <td>1079.9900</td>
      <td>4911.7400</td>
      <td>1.846992e+10</td>
      <td>7.969529e+10</td>
    </tr>
    <tr>
      <th>2017-10-02</th>
      <td>5.506455e+08</td>
      <td>5.729890e+09</td>
      <td>4225.1750</td>
      <td>19498.6833</td>
      <td>7.021588e+10</td>
      <td>3.346692e+11</td>
    </tr>
    <tr>
      <th>2018-04-02</th>
      <td>2.724822e+08</td>
      <td>1.986371e+09</td>
      <td>5908.7025</td>
      <td>9803.3067</td>
      <td>1.005508e+11</td>
      <td>1.668274e+11</td>
    </tr>
    <tr>
      <th>2018-10-01</th>
      <td>2.236265e+08</td>
      <td>2.721201e+09</td>
      <td>3242.4200</td>
      <td>6626.8500</td>
      <td>5.620096e+10</td>
      <td>1.146456e+11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As with <code class="docutils literal notranslate"><span class="pre">groupby</span></code> and <code class="docutils literal notranslate"><span class="pre">rolling</span></code>, you can also provide custom
functions to <code class="docutils literal notranslate"><span class="pre">.resample(...).agg</span></code> and <code class="docutils literal notranslate"><span class="pre">.resample(...).apply</span></code></p>
<div class="admonition-exercise admonition" id="pd-tim-dir7">
<p class="admonition-title">Exercise</p>
<p>See exercise 7 in the <a class="reference internal" href="#pd-tim-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
<p>To make the optimal decision we need to, for each month,
compute the maximum value of the close price on any day minus the open
price on the first day of the month.</p>
<div class="admonition-exercise admonition" id="pd-tim-dir8">
<p class="admonition-title">Exercise</p>
<p>See exercise 8 in the <a class="reference internal" href="#pd-tim-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
</section>
<section id="optional-api-keys">
<h2>Optional: API keys<a class="headerlink" href="#optional-api-keys" title="Permalink to this heading">#</a></h2>
<p>Recall above that we had the line of code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ndl</span><span class="o">.</span><span class="n">ApiConfig</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;NASDAQ_DATA_LINK_API_KEY&quot;</span><span class="p">,</span> <span class="s2">&quot;jEKP58z7JaX6utPkkpEp&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This line told the <code class="docutils literal notranslate"><span class="pre">nasdaqdatalink</span></code> library that when obtaining making requests for data, it should use the <em>API key</em> <code class="docutils literal notranslate"><span class="pre">jEKP58z7JaX6utPkkpEp</span></code>.</p>
<p>An API key is a sort of password that web services (like the Nasdaq Data Link API) require you to provide when you make requests.</p>
<p>Using this password, we were able to make a request to Nasdaq data link to obtain data directly from them.</p>
<p>The API key used here is one that we requested on behalf of this course. If you create your own API key, you should store it in the NASDAQ_DATA_LINK_API_KEY environment variable, locally on your computer. Using an environment variable like this is a common way to store sensitive information like API keys, since you can set the environment variable in a secure way that is not stored in your code. How to set environment variables varies by operating system, but you can find instructions for doing so on the web.</p>
<p>If you plan to use Nasdaq data more extensively, you should obtain your own personal API key from <a class="reference external" href="https://www.nasdaq.com/nasdaq-data-link">their website</a> and re-run the <code class="docutils literal notranslate"><span class="pre">os.environ...</span></code> line of code with your new API key on the right-hand side.</p>
</section>
<section id="exercises">
<span id="pd-tim-ex"></span><h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this heading">#</a></h3>
<p>By referring to table found at the link above, figure out the correct argument to
pass as <code class="docutils literal notranslate"><span class="pre">format</span></code> in order to parse the dates in the next three cells below.</p>
<p>Test your work by passing your format string to <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">christmas_str2</span> <span class="o">=</span> <span class="s2">&quot;2017:12:25&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dbacks_win</span> <span class="o">=</span> <span class="s2">&quot;M:11 D:4 Y:2001 9:15 PM&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">america_bday</span> <span class="o">=</span> <span class="s2">&quot;America was born on July 4, 1776&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>(<a class="reference internal" href="#pd-tim-dir1"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this heading">#</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> to express the birthday of one of your friends
or family members as a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object.</p>
<p>Then use the <code class="docutils literal notranslate"><span class="pre">strftime</span></code> method to write a message of the format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">NAME</span><span class="s1">&#39;s birthday is June 10, 1989 (a Saturday)</span>
</pre></div>
</div>
<p>(where the name and date are replaced by the appropriate values)</p>
<p>(<a class="reference internal" href="#pd-tim-dir2"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-3">
<h3>Exercise 3<a class="headerlink" href="#exercise-3" title="Permalink to this heading">#</a></h3>
<p>For each item in the list, extract the specified data from <code class="docutils literal notranslate"><span class="pre">btc_usd</span></code>:</p>
<ul class="simple">
<li><p>July 2017 through August 2017 (inclusive)</p></li>
<li><p>April 25, 2015 to June 10, 2016</p></li>
<li><p>October 31, 2017</p></li>
</ul>
<p>(<a class="reference internal" href="#pd-tim-dir3"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-4">
<h3>Exercise 4<a class="headerlink" href="#exercise-4" title="Permalink to this heading">#</a></h3>
<p>Using the <code class="docutils literal notranslate"><span class="pre">shift</span></code> function, determine the week with the largest percent change
in the volume of trades (the <code class="docutils literal notranslate"><span class="pre">&quot;Volume</span> <span class="pre">(BTC)&quot;</span></code> column).</p>
<p>Repeat the analysis at the bi-weekly and monthly frequencies.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>We have data at a <em>daily</em> frequency and one week is <code class="docutils literal notranslate"><span class="pre">7</span></code> days.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Approximate a month by 30 days.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here</span>
</pre></div>
</div>
</div>
</div>
<p>(<a class="reference internal" href="#pd-tim-dir4"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-5">
<h3>Exercise 5<a class="headerlink" href="#exercise-5" title="Permalink to this heading">#</a></h3>
<p>Imagine that you have access to the <a class="reference external" href="https://en.wikipedia.org/wiki/DeLorean_time_machine">DeLorean time machine</a>
from “Back to the Future”.</p>
<p>You are allowed to use the DeLorean only once, subject to the following
conditions:</p>
<ul class="simple">
<li><p>You may travel back to any day in the past.</p></li>
<li><p>On that day, you may purchase one bitcoin <em>at market open</em>.</p></li>
<li><p>You can then take the time machine 30 days into the future and sell your bitcoin <em>at market close</em>.</p></li>
<li><p>Then you return to the present, pocketing the profits.</p></li>
</ul>
<p>How would you pick the day?</p>
<p>Think carefully about what you would need to compute to make the
optimal choice. Try writing it out in the markdown cell below so you
have a clear description of the <em>want</em> operator that we will apply after
the exercise.</p>
<p>(Note: <strong>Don’t</strong> look too far below, because in the next non-empty cell
we have written out our answer.)</p>
<p>To make this decision, we want to know …</p>
<p><strong>Your answer here</strong></p>
<p>(<a class="reference internal" href="#pd-tim-dir5"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-6">
<h3>Exercise 6<a class="headerlink" href="#exercise-6" title="Permalink to this heading">#</a></h3>
<p>Do the following:</p>
<ol class="arabic simple">
<li><p>Write a pandas function that implements your strategy.</p></li>
<li><p>Pass it to the <code class="docutils literal notranslate"><span class="pre">agg</span></code> method of <code class="docutils literal notranslate"><span class="pre">rolling_btc</span></code>.</p></li>
<li><p>Extract the <code class="docutils literal notranslate"><span class="pre">&quot;Open&quot;</span></code> column from the result.</p></li>
<li><p>Find the date associated with the maximum value in that column.</p></li>
</ol>
<p>How much money did you make? Compare with your neighbor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">daily_value</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="c1"># DELETE `pass` below and replace it with your code</span>
    <span class="k">pass</span>

<span class="n">rolling_btc</span> <span class="o">=</span> <span class="n">btc_usd</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="s2">&quot;30d&quot;</span><span class="p">)</span>

<span class="c1"># do steps 2-4 here</span>
</pre></div>
</div>
</div>
</div>
<p>(<a class="reference internal" href="#pd-tim-dir6"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-7">
<h3>Exercise 7<a class="headerlink" href="#exercise-7" title="Permalink to this heading">#</a></h3>
<p>Now suppose you still have access to the DeLorean, but the conditions are
slightly different.</p>
<p>You may now:</p>
<ul class="simple">
<li><p>Travel back to the <em>first day</em> of any month in the past.</p></li>
<li><p>On that day, you may purchase one bitcoin <em>at market open</em>.</p></li>
<li><p>You can then travel to any day <em>in that month</em> and sell the bitcoin <em>at market close</em>.</p></li>
<li><p>Then return to the present, pocketing the profits.</p></li>
</ul>
<p>To which month would you travel? On which day of that month would you return
to sell the bitcoin?</p>
<p>Discuss with your neighbor what you would need to compute to make the
optimal choice. Try writing it out in the markdown cell below so you
have a clear description of the <em>want</em> operator that we will apply after
the exercise.</p>
<p>(Note: <strong>Don’t</strong> look too many cells below, because we have written out
our answer.)</p>
<p>To make the optimal decision we need …</p>
<p><strong>Your answer here</strong></p>
<p>(<a class="reference internal" href="#pd-tim-dir7"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-8">
<h3>Exercise 8<a class="headerlink" href="#exercise-8" title="Permalink to this heading">#</a></h3>
<p>Do the following:</p>
<ol class="arabic simple">
<li><p>Write a pandas function that implements your strategy.</p></li>
<li><p>Pass it to the <code class="docutils literal notranslate"><span class="pre">agg</span></code> method of <code class="docutils literal notranslate"><span class="pre">resampled_btc</span></code>.</p></li>
<li><p>Extract the <code class="docutils literal notranslate"><span class="pre">&quot;Open&quot;</span></code> column from the result.</p></li>
<li><p>Find the date associated with the maximum value in that column.</p></li>
</ol>
<p>How much money did you make? Compare with your neighbor.</p>
<p>Was this strategy more profitable than the previous one? By how much?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">monthly_value</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="c1"># DELETE `pass` below and replace it with your code</span>
    <span class="k">pass</span>

<span class="n">resampled_btc</span> <span class="o">=</span> <span class="n">btc_usd</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;MS&quot;</span><span class="p">)</span>

<span class="c1"># Do steps 2-4 here</span>
</pre></div>
</div>
</div>
</div>
<p>(<a class="reference internal" href="#pd-tim-dir8"><span class="std std-ref">back to text</span></a>)</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./pandas"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                    <p>A theme by <a href="https://quantecon.org">QuantEcon</a></p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive persistent" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/index.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/overview.html">
   Course Description
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/getting_started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/cloud_setup.html">
   Cloud Setup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/local_install.html">
   Local Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/troubleshooting.html">
   Troubleshooting
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python Fundamentals
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/index.html">
   Python Fundamentals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/basics.html">
   Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/collections.html">
   Collections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/control_flow.html">
   Control Flow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/functions.html">
   Functions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Scientific Computing
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/index.html">
   Scientific Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/numpy_arrays.html">
   Introduction to Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/plotting.html">
   Plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/applied_linalg.html">
   Applied Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/randomness.html">
   Randomness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/optimization.html">
   Optimization
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Pandas
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   DataFrames and Series in Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="basics.html">
   Basic Functionality
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="the_index.html">
   The Index
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="storage_formats.html">
   Storage Formats
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_clean.html">
   Cleaning Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reshape.html">
   Reshape
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="merge.html">
   Merge
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="groupby.html">
   GroupBy
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   Time series
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Science Tools
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/index.html">
   Data Science Tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/matplotlib.html">
   Intermediate Plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/maps.html">
   Mapping in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/visualization_rules.html">
   Data Visualization: Rules and Guidelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/regression.html">
   Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/classification.html">
   Classification
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Applications
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/index.html">
   Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/ml_in_economics.html">
   Machine Learning in Economics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/networks.html">
   Social and Economic Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/recidivism.html">
   Case Study: Recidivism
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/working_with_text.html">
   Working with Text
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/heterogeneity.html">
   Heterogeneous Effects
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="../index.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="../search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/pandas/timeseries.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-datascience.myst/blob/main/lectures/pandas/timeseries.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-datascience.myst" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-datascience.notebooks/blob/main/pandas/timeseries.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-datascience.notebooks" data-urlpath="tree/lecture-datascience.notebooks/pandas/timeseries.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-datascience.notebooks/blob/main/pandas/timeseries.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "pandas/timeseries";
                const repoURL = "https://github.com/QuantEcon/lecture-datascience.notebooks";
                const urlPath = "tree/lecture-datascience.notebooks/pandas/timeseries.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>