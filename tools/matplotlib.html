

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Intermediate Plotting &#8212; QuantEcon DataScience</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/quantecon-book-theme.279dae03c5caae754d20501e3fa00bbf.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />


    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script src="../_static/quantecon-book-theme.15b0c36fffe88f468997fa7b698991d3.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-S8CBQPC844"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-S8CBQPC844');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tools/matplotlib';</script>
    <link rel="canonical" href="https://datascience.quantecon.org/tools/matplotlib.html" />
    <link rel="shortcut icon" href="../_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Mapping in Python" href="maps.html" />
    <link rel="prev" title="Data Science Tools" href="index.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Chase Coleman, Spencer Lyon, and Jesse Perla" />
<meta name="keywords" content="Python, QuantEcon, DataScience" />
<meta name="description" content=This website presents a series of lectures on programming, data science, and economics. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Intermediate Plotting"/>
<meta name="twitter:description" content="This website presents a series of lectures on programming, data science, and economics.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Intermediate Plotting" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://datascience.quantecon.org/tools/matplotlib.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a series of lectures on programming, data science, and economics." />
<meta property="og:site_name" content="QuantEcon DataScience" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=tools/matplotlib>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-want-operator-replicate-a-professional-figure">The Want Operator: Replicate a Professional Figure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#warmup">Warmup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">Data Cleaning</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-the-plot">Constructing the Plot</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subplot-spacing-fig-tight-layout">Subplot Spacing: <code class="docutils literal notranslate"><span class="pre">fig.tight_layout</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#properties-of-the-figure">Properties of the Figure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#properties-of-an-axes">Properties of an <code class="docutils literal notranslate"><span class="pre">Axes</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transforms-and-lines">Transforms and Lines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#annotations">Annotations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-figure">Saving the Figure</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
</ul>
</li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="../_static/datascience-logo.png" class="logo" alt="logo"></a>
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="../index.html">QuantEcon DataScience</a></p>

                        <p class="qe-page__header-subheading">Intermediate Plotting</p>

                    </div>

                    <p class="qe-page__header-authors">Chase Coleman, Spencer Lyon, and Jesse Perla</p>

                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="intermediate-plotting">
<h1>Intermediate Plotting<a class="headerlink" href="#intermediate-plotting" title="Permalink to this heading">#</a></h1>
<p><strong>Prerequisites</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="../pandas/intro.html"><span class="doc">Introduction</span></a></p></li>
</ul>
<p><strong>Outcomes</strong></p>
<ul class="simple">
<li><p>Be able to build visualizations with multiple subplots</p></li>
<li><p>Add plot elements using data from multiple DataFrames</p></li>
<li><p>Understand the relationship between the matplotlib Figure and Axes
objects</p></li>
<li><p>Customize fonts, legends, axis labels, tick labels, titles, and more!</p></li>
<li><p>Save figures to files to add to presentation, email, or use outside
of a Jupyter notebook</p></li>
</ul>
<p><strong>Data</strong></p>
<ul class="simple">
<li><p>iPhone announcement dates</p></li>
<li><p>Apple stock price</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment following line to install on colab</span>
<span class="c1">#! pip install </span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.transforms</span> <span class="k">as</span> <span class="nn">transforms</span>
<span class="kn">import</span> <span class="nn">quandl</span>

<span class="n">quandl</span><span class="o">.</span><span class="n">ApiConfig</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;QUANDL_AUTH&quot;</span><span class="p">,</span> <span class="s2">&quot;Dn6BtVoBhzuKTuyo6hbp&quot;</span><span class="p">)</span>


<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>We have already seen a few examples of basic visualizations created
using the <code class="docutils literal notranslate"><span class="pre">.plot</span></code> method for a DataFrame.</p>
<p>When we use the <code class="docutils literal notranslate"><span class="pre">.plot</span></code> method, pandas uses a package called
matplotlib that actually creates the visualization.</p>
<p>In this lecture, we will dive deeper into the customization options in
the DataFrame <code class="docutils literal notranslate"><span class="pre">.plot</span></code> method as well as look under the hood at how to
use matplotlib directly to unlock unlimited control over our figures.</p>
</section>
<section id="the-want-operator-replicate-a-professional-figure">
<h2>The Want Operator: Replicate a Professional Figure<a class="headerlink" href="#the-want-operator-replicate-a-professional-figure" title="Permalink to this heading">#</a></h2>
<p>Visualization is a complex subject.</p>
<p><a class="reference external" href="https://www.amazon.com/s/ref=nb_sb_noss?url=search-alias%3Dstripbooks&amp;field-keywords=data+visualization&amp;rh=n%3A283155%2Ck%3Adata+visualization">Many
books</a>
have been written on the subject.</p>
<p>We cannot hope to convey all of what is possible in a short lecture, so
we thought we’d try something fun instead.</p>
<p>Our goal in this lecture is to show off some of the common – and some
not-so-common – matplotlib capabilities to try to re-create this
striking figure from a Financial Times
<a class="reference external" href="https://www.ft.com/content/4743ce96-e4bf-11e7-97e2-916d4fbac0da">article</a>.</p>
<p>The figure shows how we can see the anticipation of and response to iPhone
announcements in Apple stock share prices.</p>
<figure class="align-default">
<img alt="aapl\_iphone\_announcments.png" src="../_images/aapl_iphone_announcments.png" />
</figure>
<p>Our goal is to replicate the top portion of this figure in this lecture.</p>
<p><strong>Disclaimer</strong>: Many tools you will see in this lecture will be
“more advanced” than what you typically use when customizing a plot.
Don’t (please!) try to memorize the commands used here – the purpose of
the lecture is to show what is possible and expose you a variety of the
methods you can use.</p>
</section>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Permalink to this heading">#</a></h2>
<p>Let’s get the data.</p>
<p>First, we create a Series containing the date of each iPhone
announcement that appears in the FT original chart.</p>
<p>As there have only been 11 of them and we couldn’t find this “dataset”
online anywhere, we will do this by hand.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">announcement_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="s2">&quot;First iPhone&quot;</span><span class="p">,</span> <span class="s2">&quot;3G&quot;</span><span class="p">,</span> <span class="s2">&quot;3GS&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;4S&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;5S/5C&quot;</span><span class="p">,</span> <span class="s2">&quot;6/6 Plus&quot;</span><span class="p">,</span>
        <span class="s2">&quot;6S/6S Plus&quot;</span><span class="p">,</span> <span class="s2">&quot;7/7 Plus&quot;</span><span class="p">,</span> <span class="s2">&quot;8/8 Plus/X&quot;</span>
    <span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span>
        <span class="s2">&quot;Jan. 9, 2007&quot;</span><span class="p">,</span> <span class="s2">&quot;Jun. 9, 2008&quot;</span><span class="p">,</span> <span class="s2">&quot;Jun. 8, 2009&quot;</span><span class="p">,</span> <span class="s2">&quot;Jan. 11, 2011&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Oct. 4, 2011&quot;</span><span class="p">,</span> <span class="s2">&quot;Sep. 12, 2012&quot;</span><span class="p">,</span> <span class="s2">&quot;Sep. 10, 2013&quot;</span><span class="p">,</span> <span class="s2">&quot;Sep. 9, 2014&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sep. 9, 2015&quot;</span><span class="p">,</span> <span class="s2">&quot;Sep. 7, 2016&quot;</span><span class="p">,</span> <span class="s2">&quot;Sep. 12, 2017&quot;</span>
    <span class="p">]),</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Model&quot;</span>
<span class="p">)</span>
<span class="n">announcement_dates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2007-01-09    First iPhone
2008-06-09              3G
2009-06-08             3GS
2011-01-11               4
2011-10-04              4S
2012-09-12               5
2013-09-10           5S/5C
2014-09-09        6/6 Plus
2015-09-09      6S/6S Plus
2016-09-07        7/7 Plus
2017-09-12      8/8 Plus/X
Name: Model, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Then, let’s grab Apple’s stock price data from quandl, starting a few
weeks before the first announcement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aapl</span> <span class="o">=</span> <span class="n">quandl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;WIKI/AAPL&quot;</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2006-12-25&quot;</span><span class="p">)</span>
<span class="n">aapl</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Ex-Dividend</th>
      <th>Split Ratio</th>
      <th>Adj. Open</th>
      <th>Adj. High</th>
      <th>Adj. Low</th>
      <th>Adj. Close</th>
      <th>Adj. Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-26</th>
      <td>82.15</td>
      <td>82.57</td>
      <td>80.89</td>
      <td>81.51</td>
      <td>17524600.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>10.557420</td>
      <td>10.611396</td>
      <td>10.395492</td>
      <td>10.475171</td>
      <td>122672200.0</td>
    </tr>
    <tr>
      <th>2006-12-27</th>
      <td>78.15</td>
      <td>82.00</td>
      <td>76.77</td>
      <td>81.52</td>
      <td>69134100.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>10.043364</td>
      <td>10.538143</td>
      <td>9.866015</td>
      <td>10.476456</td>
      <td>483938700.0</td>
    </tr>
    <tr>
      <th>2006-12-28</th>
      <td>80.22</td>
      <td>81.25</td>
      <td>79.65</td>
      <td>80.87</td>
      <td>39995600.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>10.309388</td>
      <td>10.441757</td>
      <td>10.236135</td>
      <td>10.392922</td>
      <td>279969200.0</td>
    </tr>
    <tr>
      <th>2006-12-29</th>
      <td>83.95</td>
      <td>85.40</td>
      <td>83.36</td>
      <td>84.84</td>
      <td>38443900.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>10.788745</td>
      <td>10.975090</td>
      <td>10.712922</td>
      <td>10.903122</td>
      <td>269107300.0</td>
    </tr>
    <tr>
      <th>2007-01-03</th>
      <td>86.29</td>
      <td>86.58</td>
      <td>81.90</td>
      <td>83.80</td>
      <td>44225700.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>11.089468</td>
      <td>11.126737</td>
      <td>10.525291</td>
      <td>10.769468</td>
      <td>309579900.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="warmup">
<h2>Warmup<a class="headerlink" href="#warmup" title="Permalink to this heading">#</a></h2>
<p>Matplotlib figures are composed two main types of Python objects:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Figure</span></code>: represents the entirety of the visualization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Axes</span></code>: A (potentially full) subset of the figure on which things
are drawn</p></li>
</ol>
<p>Most of the time, we will customize our plots by calling methods on an
Axes object.</p>
<p>However, things like setting a title over the entire plot or saving the
plot to a file on your computer require methods on a <code class="docutils literal notranslate"><span class="pre">Figure</span></code>.</p>
<p>Let’s start by getting our hands dirty and practicing using these
objects.</p>
<div class="admonition-exercise admonition" id="pd-mpl-dir1">
<p class="admonition-title">Exercise</p>
<p>See exercise 1 in the <a class="reference internal" href="#pd-mpl-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
<p>You should have seen that the object returned by the <code class="docutils literal notranslate"><span class="pre">.plot</span></code> method is
a matplotlib Axes.</p>
<p>As mentioned above, we can control most aspects of a plot by calling
methods on an Axes.</p>
<p>Let’s see some examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the Adjusted open to account for stock split</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">aapl</span><span class="p">[</span><span class="s2">&quot;Adj. Open&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># get the figure so we can re-display the plot after making changes</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/38a7190896905f6bdc2cc4bf2b8593c102d098acac673e3399cb5eb508d577d5.png" src="../_images/38a7190896905f6bdc2cc4bf2b8593c102d098acac673e3399cb5eb508d577d5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set the title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;AAPL Adjusted opening price&quot;</span><span class="p">)</span>

<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1e879e36d42349d5af141cceff72c4dbeaac94562007e70375c9159ba1878344.png" src="../_images/1e879e36d42349d5af141cceff72c4dbeaac94562007e70375c9159ba1878344.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9bf643f3d9d6c1ee9d5bceeb904532b311d3dc0235f99f409fd0f7c58d609829.png" src="../_images/9bf643f3d9d6c1ee9d5bceeb904532b311d3dc0235f99f409fd0f7c58d609829.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b3107c9838a2da06caab6800431fe5e6180a451d0154009e0d60c78dbb1f3d74.png" src="../_images/b3107c9838a2da06caab6800431fe5e6180a451d0154009e0d60c78dbb1f3d74.png" />
</div>
</div>
<p>We can also create a Figure and Axes beforehand and then tell pandas to
plot a DataFrame or Series’ data on the axis.</p>
<p>We typically use the <code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code> function to create the Figure and
Axes.</p>
<p>Below, we use this function to create a Figure that is 10 inches wide by
6 inches tall and filled with a one by two grid of Axes objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">axs2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;type(fig2): &quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">fig2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;type(axs): &quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">axs2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;axs2.shape: &quot;</span><span class="p">,</span> <span class="n">axs2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>type(fig2):  &lt;class &#39;matplotlib.figure.Figure&#39;&gt;
type(axs):  &lt;class &#39;numpy.ndarray&#39;&gt;
axs2.shape:  (2,)
</pre></div>
</div>
<img alt="../_images/35dbb775bef3b33481400889a99f37ee6d41c42e306278b7b2c6a22b70adee1d.png" src="../_images/35dbb775bef3b33481400889a99f37ee6d41c42e306278b7b2c6a22b70adee1d.png" />
</div>
</div>
<p>We can plot from our DataFrame directly on our Axes objects by setting
the <code class="docutils literal notranslate"><span class="pre">ax</span></code> argument when calling <code class="docutils literal notranslate"><span class="pre">.plot</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aapl</span><span class="p">[[</span><span class="s2">&quot;Adj. Low&quot;</span><span class="p">,</span> <span class="s2">&quot;Adj. High&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">aapl</span><span class="p">[[</span><span class="s2">&quot;Low&quot;</span><span class="p">,</span> <span class="s2">&quot;High&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2371a924119ef621db226626bffb0de2a524535a7cfcdd9ce99700a345cd637a.png" src="../_images/2371a924119ef621db226626bffb0de2a524535a7cfcdd9ce99700a345cd637a.png" />
</div>
</div>
<div class="admonition-exercise admonition" id="pd-mpl-dir2">
<p class="admonition-title">Exercise</p>
<p>See exercise 2 in the <a class="reference internal" href="#pd-mpl-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
<div class="admonition-exercise admonition" id="pd-mpl-dir3">
<p class="admonition-title">Exercise</p>
<p>See exercise 3 in the <a class="reference internal" href="#pd-mpl-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
</section>
<section id="data-cleaning">
<h2>Data Cleaning<a class="headerlink" href="#data-cleaning" title="Permalink to this heading">#</a></h2>
<p>Let’s continue on our path to recreating the Financial Times
visualization from above.</p>
<p>Before we can actually make the plot, we first have to clean the data.</p>
<p>Looking at our goal, we will need share price three days before and
after each announcement.</p>
<p>We will also need to normalize the share price to be 100 on the day of
the announcement and scale the neighboring days accordingly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas.tseries.holiday</span> <span class="kn">import</span> <span class="n">USFederalHolidayCalendar</span>
<span class="kn">from</span> <span class="nn">pandas.tseries.offsets</span> <span class="kn">import</span> <span class="n">CustomBusinessDay</span>

<span class="n">bday_us</span> <span class="o">=</span> <span class="n">CustomBusinessDay</span><span class="p">(</span><span class="n">calendar</span><span class="o">=</span><span class="n">USFederalHolidayCalendar</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">neighbor_dates</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">nbefore</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nafter</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="c1"># Make sure the date is a datetime</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>

    <span class="c1"># Create a list of business days</span>
    <span class="n">before_and_after</span> <span class="o">=</span> <span class="p">[</span><span class="n">date</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="n">bday_us</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">nbefore</span><span class="p">,</span> <span class="n">nafter</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">before_and_after</span>


<span class="n">dates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ann_date</span> <span class="ow">in</span> <span class="n">announcement_dates</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="n">dates</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">neighbor_dates</span><span class="p">(</span><span class="n">ann_date</span><span class="p">))</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>

<span class="c1"># Index into our DataFrame using the new dates</span>
<span class="n">prices</span> <span class="o">=</span> <span class="n">aapl</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dates</span><span class="p">]</span>
<span class="n">prices</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Ex-Dividend</th>
      <th>Split Ratio</th>
      <th>Adj. Open</th>
      <th>Adj. High</th>
      <th>Adj. Low</th>
      <th>Adj. Close</th>
      <th>Adj. Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2007-01-04</th>
      <td>84.05</td>
      <td>85.95</td>
      <td>83.82</td>
      <td>85.66</td>
      <td>30259300.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>10.801596</td>
      <td>11.045773</td>
      <td>10.772038</td>
      <td>11.008504</td>
      <td>211815100.0</td>
    </tr>
    <tr>
      <th>2007-01-05</th>
      <td>85.77</td>
      <td>86.20</td>
      <td>84.40</td>
      <td>85.05</td>
      <td>29812200.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>11.022640</td>
      <td>11.077901</td>
      <td>10.846576</td>
      <td>10.930110</td>
      <td>208685400.0</td>
    </tr>
    <tr>
      <th>2007-01-08</th>
      <td>85.96</td>
      <td>86.53</td>
      <td>85.28</td>
      <td>85.47</td>
      <td>28468100.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>11.047058</td>
      <td>11.120311</td>
      <td>10.959669</td>
      <td>10.984086</td>
      <td>199276700.0</td>
    </tr>
    <tr>
      <th>2007-01-09</th>
      <td>86.45</td>
      <td>92.98</td>
      <td>85.15</td>
      <td>92.57</td>
      <td>119617800.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>11.110030</td>
      <td>11.949226</td>
      <td>10.942962</td>
      <td>11.896535</td>
      <td>837324600.0</td>
    </tr>
    <tr>
      <th>2007-01-10</th>
      <td>94.75</td>
      <td>97.80</td>
      <td>93.45</td>
      <td>97.00</td>
      <td>105460000.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>12.176696</td>
      <td>12.568663</td>
      <td>12.009627</td>
      <td>12.465852</td>
      <td>738220000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We now want to bring information on iPhone models into the DataFrame.</p>
<p>We do this by:</p>
<ul class="simple">
<li><p>Joining on the announcement date. This will introduce a new column
named <code class="docutils literal notranslate"><span class="pre">Model</span></code> which has a value in the announcement date but has 3
<code class="docutils literal notranslate"><span class="pre">NaN</span></code> above and below each announcement date (a total of 66
<code class="docutils literal notranslate"><span class="pre">NaN</span></code>)</p></li>
<li><p>Using the methods <code class="docutils literal notranslate"><span class="pre">ffill</span></code> and <code class="docutils literal notranslate"><span class="pre">bfill</span></code>, we can replace these
<code class="docutils literal notranslate"><span class="pre">NaN</span></code>s with the corresponding model names.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prices.ffill(limit=3)</span></code> will fill the three days <em>after</em> the
announcement with the model name (down to 33 Nan)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prices.bfill(limit=3)</span></code> will fill the three days <em>before</em> the
announcement with the model name (no more <code class="docutils literal notranslate"><span class="pre">NaN</span></code>)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prices</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">announcement_dates</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prices</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">prices</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>66
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2007-01-04             NaN
2007-01-05             NaN
2007-01-08             NaN
2007-01-09    First iPhone
2007-01-10             NaN
2007-01-11             NaN
2007-01-12             NaN
Name: Model, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prices</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">ffill</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prices</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">prices</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>33
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2007-01-04             NaN
2007-01-05             NaN
2007-01-08             NaN
2007-01-09    First iPhone
2007-01-10    First iPhone
2007-01-11    First iPhone
2007-01-12    First iPhone
Name: Model, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prices</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">bfill</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prices</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">prices</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2007-01-04    First iPhone
2007-01-05    First iPhone
2007-01-08    First iPhone
2007-01-09    First iPhone
2007-01-10    First iPhone
2007-01-11    First iPhone
2007-01-12    First iPhone
Name: Model, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Success!</p>
<p>Now for the second part of the cleaning: normalize the share price on
each announcement date to 100 and scale all neighbors accordingly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scale_by_middle</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="c1"># How many rows</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Divide by middle row and scale to 100</span>
    <span class="c1"># Note: N // 2 is modulus division meaning that it is</span>
    <span class="c1">#       rounded to nearest whole number)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Open&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="s2">&quot;Open&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="c1"># We don&#39;t want to keep actual dates, but rather the number</span>
    <span class="c1"># of days before or after the announcment. Let&#39;s set that</span>
    <span class="c1"># as the index. Note the +1 because range excludes upper limit</span>
    <span class="n">out</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span> <span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

    <span class="c1"># also change the name of this series</span>
    <span class="n">out</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;DeltaDays&quot;</span>
    <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">to_plot</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Model&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scale_by_middle</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">to_plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Model</th>
      <th>3G</th>
      <th>3GS</th>
      <th>4</th>
      <th>4S</th>
      <th>5</th>
      <th>5S/5C</th>
      <th>6/6 Plus</th>
      <th>6S/6S Plus</th>
      <th>7/7 Plus</th>
      <th>8/8 Plus/X</th>
      <th>First iPhone</th>
    </tr>
    <tr>
      <th>DeltaDays</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-3</th>
      <td>99.502488</td>
      <td>97.343902</td>
      <td>97.053874</td>
      <td>107.301706</td>
      <td>101.679538</td>
      <td>98.824575</td>
      <td>99.767864</td>
      <td>98.883615</td>
      <td>98.432718</td>
      <td>99.680216</td>
      <td>97.223829</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>100.719230</td>
      <td>97.434293</td>
      <td>96.842380</td>
      <td>103.350509</td>
      <td>102.039439</td>
      <td>98.467009</td>
      <td>99.717400</td>
      <td>95.789381</td>
      <td>99.879440</td>
      <td>98.923805</td>
      <td>99.213418</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>101.665585</td>
      <td>101.036017</td>
      <td>98.245767</td>
      <td>101.548442</td>
      <td>99.739072</td>
      <td>99.762940</td>
      <td>100.222043</td>
      <td>98.145218</td>
      <td>100.064917</td>
      <td>98.702417</td>
      <td>99.433198</td>
    </tr>
    <tr>
      <th>0</th>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>97.517846</td>
      <td>99.993047</td>
      <td>99.527372</td>
      <td>98.208613</td>
      <td>101.577566</td>
      <td>92.258021</td>
      <td>98.920065</td>
      <td>96.932138</td>
      <td>99.462116</td>
      <td>98.314987</td>
      <td>109.600925</td>
    </tr>
    <tr>
      <th>2</th>
      <td>99.686351</td>
      <td>98.929217</td>
      <td>100.081188</td>
      <td>99.668954</td>
      <td>103.464797</td>
      <td>92.552351</td>
      <td>101.342350</td>
      <td>98.268284</td>
      <td>97.041640</td>
      <td>97.773815</td>
      <td>110.977444</td>
    </tr>
    <tr>
      <th>3</th>
      <td>98.123513</td>
      <td>97.031011</td>
      <td>100.292855</td>
      <td>100.323037</td>
      <td>104.873660</td>
      <td>92.718333</td>
      <td>102.149778</td>
      <td>102.478903</td>
      <td>95.196142</td>
      <td>97.454031</td>
      <td>109.415847</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Re-order the columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">to_plot</span> <span class="o">=</span> <span class="n">to_plot</span><span class="p">[</span><span class="n">announcement_dates</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">to_plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Model</th>
      <th>First iPhone</th>
      <th>3G</th>
      <th>3GS</th>
      <th>4</th>
      <th>4S</th>
      <th>5</th>
      <th>5S/5C</th>
      <th>6/6 Plus</th>
      <th>6S/6S Plus</th>
      <th>7/7 Plus</th>
      <th>8/8 Plus/X</th>
    </tr>
    <tr>
      <th>DeltaDays</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-3</th>
      <td>97.223829</td>
      <td>99.502488</td>
      <td>97.343902</td>
      <td>97.053874</td>
      <td>107.301706</td>
      <td>101.679538</td>
      <td>98.824575</td>
      <td>99.767864</td>
      <td>98.883615</td>
      <td>98.432718</td>
      <td>99.680216</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>99.213418</td>
      <td>100.719230</td>
      <td>97.434293</td>
      <td>96.842380</td>
      <td>103.350509</td>
      <td>102.039439</td>
      <td>98.467009</td>
      <td>99.717400</td>
      <td>95.789381</td>
      <td>99.879440</td>
      <td>98.923805</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>99.433198</td>
      <td>101.665585</td>
      <td>101.036017</td>
      <td>98.245767</td>
      <td>101.548442</td>
      <td>99.739072</td>
      <td>99.762940</td>
      <td>100.222043</td>
      <td>98.145218</td>
      <td>100.064917</td>
      <td>98.702417</td>
    </tr>
    <tr>
      <th>0</th>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>109.600925</td>
      <td>97.517846</td>
      <td>99.993047</td>
      <td>99.527372</td>
      <td>98.208613</td>
      <td>101.577566</td>
      <td>92.258021</td>
      <td>98.920065</td>
      <td>96.932138</td>
      <td>99.462116</td>
      <td>98.314987</td>
    </tr>
    <tr>
      <th>2</th>
      <td>110.977444</td>
      <td>99.686351</td>
      <td>98.929217</td>
      <td>100.081188</td>
      <td>99.668954</td>
      <td>103.464797</td>
      <td>92.552351</td>
      <td>101.342350</td>
      <td>98.268284</td>
      <td>97.041640</td>
      <td>97.773815</td>
    </tr>
    <tr>
      <th>3</th>
      <td>109.415847</td>
      <td>98.123513</td>
      <td>97.031011</td>
      <td>100.292855</td>
      <td>100.323037</td>
      <td>104.873660</td>
      <td>92.718333</td>
      <td>102.149778</td>
      <td>102.478903</td>
      <td>95.196142</td>
      <td>97.454031</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="constructing-the-plot">
<h2>Constructing the Plot<a class="headerlink" href="#constructing-the-plot" title="Permalink to this heading">#</a></h2>
<p>Now that we have cleaned up the data, let’s construct the plot.</p>
<p>We do this by using the DataFrame <code class="docutils literal notranslate"><span class="pre">.plot</span></code> method and then using the
matplotlib methods and functions to fine tune our plot, changing one
feature or set of features at a time.</p>
<p>To prepare our use of the plot method, we will need to set up some data
for what color each line should be, as well as where to draw the tick
marks on the vertical axis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># colors</span>
<span class="n">background</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">253</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">222</span><span class="p">])</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)</span>
<span class="n">blue</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">134</span><span class="p">])</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)</span>
<span class="n">pink</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">232</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">126</span><span class="p">])</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_color</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;S&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pink</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">blue</span>

<span class="n">colors</span> <span class="o">=</span> <span class="n">announcement_dates</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">get_color</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># yticks</span>
<span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">115</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Below, we construct the basic plot using <code class="docutils literal notranslate"><span class="pre">to_plot.plot</span></code>.</p>
<p>Notice that we have specified a few options as keyword arguments to our
function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># construct figure and Axes objects</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># We can pass our array of Axes and `subplots=True`</span>
<span class="c1"># because we have one Axes per column</span>
<span class="n">to_plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">yticks</span><span class="o">=</span><span class="n">yticks</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f6bac5bfb82d9e17f325231f685a5ac50788123526000331eb5e734cffabf5ed.png" src="../_images/f6bac5bfb82d9e17f325231f685a5ac50788123526000331eb5e734cffabf5ed.png" />
</div>
</div>
<div class="admonition-exercise admonition" id="pd-mpl-dir4">
<p class="admonition-title">Exercise</p>
<p>See exercise 4 in the <a class="reference internal" href="#pd-mpl-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
<section id="subplot-spacing-fig-tight-layout">
<h3>Subplot Spacing: <code class="docutils literal notranslate"><span class="pre">fig.tight_layout</span></code><a class="headerlink" href="#subplot-spacing-fig-tight-layout" title="Permalink to this heading">#</a></h3>
<p>That figure has the basic lines we are after, but is quite ugly when
compared to the FT figure we are trying to produce.</p>
<p>Let’s refine the plot one step at a time.</p>
<p>First, notice how the <code class="docutils literal notranslate"><span class="pre">-3</span></code> and <code class="docutils literal notranslate"><span class="pre">3</span></code> labels are running into each
other?</p>
<p>This commonly happens in figures with many subplots.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">fig.tight_layout()</span></code> will fix these problems – as well
as most other subplot spacing issues.</p>
<p>We <em>almost always</em> call this method when building a plot with multiple
subplots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add some spacing around subplots</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cee003a7fa24d24de536ef110bdffa39f43f7dd29c02fc55201b85410e76826b.png" src="../_images/cee003a7fa24d24de536ef110bdffa39f43f7dd29c02fc55201b85410e76826b.png" />
</div>
</div>
</section>
<section id="properties-of-the-figure">
<h3>Properties of the Figure<a class="headerlink" href="#properties-of-the-figure" title="Permalink to this heading">#</a></h3>
<p>Now, let’s make the background of our figure match the background of the
FT post.</p>
<p>To do this, we will use the <code class="docutils literal notranslate"><span class="pre">fig.set_facecolor</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set background color</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">background</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d0efae452086413f7ea677dd9ebbadcbbee077540b8c68990aa01181d37ee2fb.png" src="../_images/d0efae452086413f7ea677dd9ebbadcbbee077540b8c68990aa01181d37ee2fb.png" />
</div>
</div>
</section>
<section id="properties-of-an-axes">
<h3>Properties of an <code class="docutils literal notranslate"><span class="pre">Axes</span></code><a class="headerlink" href="#properties-of-an-axes" title="Permalink to this heading">#</a></h3>
<p>Notice that this worked for the figure as a whole, but not for any of
the Axes.</p>
<p>To fix this, we will need to call <code class="docutils literal notranslate"><span class="pre">.set_facecolor</span></code> on each Axes.</p>
<p>While we are doing that, let’s fix up a number of other things about the
Axes:</p>
<ul class="simple">
<li><p>Add Axes titles</p></li>
<li><p>Remove the x axis titles</p></li>
<li><p>Remove tick marks on y axis</p></li>
<li><p>Add a “faint” version of the line from the first subplot</p></li>
<li><p>Remove x axis tick labels</p></li>
<li><p>Make x axis ticks longer and semi-transparent</p></li>
<li><p>Make sure all Axes have same y limits</p></li>
<li><p>Remove the spines (the border on each Axes)</p></li>
<li><p>Add a white circle to (0, 100) on each Axes</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For each Axes... do the following</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">announcement_dates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># add faint blue line representing impact of original iPhone announcement</span>
    <span class="n">to_plot</span><span class="p">[</span><span class="s2">&quot;First iPhone&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">blue</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># add a title</span>
    <span class="n">ti</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">announcement_dates</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">announcement_dates</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>

    <span class="c1"># set background color of plotting area</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">background</span><span class="p">)</span>

    <span class="c1"># remove xlabels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># turn of tick marks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># make x ticks longer and semi-transparent</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">7.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">))</span>

    <span class="c1"># set limits on vertical axis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">yticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yticks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="c1"># add a white circle at 0, 100</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="n">blue</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># remove border around each subplot</span>
    <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>


<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2c21a3cc1e92062267e742910a65b455216451c1902f89d2b9eb10f1a22052fc.png" src="../_images/2c21a3cc1e92062267e742910a65b455216451c1902f89d2b9eb10f1a22052fc.png" />
</div>
</div>
<div class="admonition-exercise admonition" id="pd-mpl-dir5">
<p class="admonition-title">Exercise</p>
<p>See exercise 5 in the <a class="reference internal" href="#pd-mpl-ex"><span class="std std-ref">exercise list</span></a>.</p>
</div>
<p>Let’s continue and add tick labels to the right of the far right
Axes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add tick labels to right of iPhone 8/X announcement</span>
<span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelright</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/762035d2b4b5eb77e6b4d0addf5c8298a6eb7d895e63d7563586dac606132da0.png" src="../_images/762035d2b4b5eb77e6b4d0addf5c8298a6eb7d895e63d7563586dac606132da0.png" />
</div>
</div>
<p>We can also add tick labels for the x-axis ticks on the 1st and 6th
plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">&quot;3 days</span><span class="se">\n</span><span class="s2">before&quot;</span><span class="p">,</span> <span class="s2">&quot;3 days</span><span class="se">\n</span><span class="s2">after&quot;</span><span class="p">])</span>

    <span class="c1"># need to make these tick labels centered at tick,</span>
    <span class="c1"># instead of the default of right aligned</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">():</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_horizontalalignment</span><span class="p">(</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3d0a8b5b16f2df54916185ad13123b214f507a6f36048abb28cc2e4a9ca33a0f.png" src="../_images/3d0a8b5b16f2df54916185ad13123b214f507a6f36048abb28cc2e4a9ca33a0f.png" />
</div>
</div>
</section>
<section id="transforms-and-lines">
<h3>Transforms and Lines<a class="headerlink" href="#transforms-and-lines" title="Permalink to this heading">#</a></h3>
<p>Now we would like to add a horizontal line that lines up with each
vertical tick label (the numbers from 90 to 115) and runs across the
entire figure.</p>
<p>This is actually harder than it sounds because most of the “drawing”
capabilities of matplotlib are built around drawing on a single Axes and
we want to draw across 11 of them.</p>
<p>However, as we promised above, anything <em>is</em> possible and we will show
you how to do it.</p>
<p>When matplotlib draws any data – be it a line, circle, rectangle, or
other – it must know what <em>coordinate system</em> to use.</p>
<p>We typically think about drawing things in the <em>data’s</em> coordinate
system (remember above how we added a white circle at (0, 100)).</p>
<p>However, we might also want to draw using two other coordinate systems:</p>
<ul class="simple">
<li><p>Figure: the bottom left of the figure is (0, 0) and top right is (1,
1)</p></li>
<li><p>Axes: The bottom left of an Axes is (0, 0) and top right is (1, 1)</p></li>
</ul>
<p>For our application, we would like to use the figure’s coordinate system
in the <code class="docutils literal notranslate"><span class="pre">x</span></code> dimension (going across the plot), but the data’s
coordinate system in the <code class="docutils literal notranslate"><span class="pre">y</span></code> dimension (so we make sure to put the
lines at each of our <code class="docutils literal notranslate"><span class="pre">yticks</span></code>).</p>
<p>Luckily for us, matplotlib provides a way to use <em>exactly</em> that coordinate
system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a transform that...</span>
<span class="n">trans</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">blended_transform_factory</span><span class="p">(</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span>  <span class="c1"># goes across whole figure in x direction</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transData</span>  <span class="c1"># goes up with the y data in the first axis</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now use <code class="docutils literal notranslate"><span class="pre">trans</span></code> to draw lines where the <code class="docutils literal notranslate"><span class="pre">x</span></code> values will map
from (0, 1) in the Figure coordinates and the <code class="docutils literal notranslate"><span class="pre">y</span></code> values will go from
(90, 115) on the data coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">yticks</span><span class="p">:</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">(</span>
        <span class="c1"># x values found by trial and error</span>
        <span class="p">[</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.985</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">zorder</span><span class="o">=</span><span class="mf">0.1</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">l</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/562a8e15c8b0fc71f14291c765ef6f5703c65bb95fe70b4623744591dfbd2ab0.png" src="../_images/562a8e15c8b0fc71f14291c765ef6f5703c65bb95fe70b4623744591dfbd2ab0.png" />
</div>
</div>
<p>Now, we need to a add vertical line from the (0, 90) to (0, 100) on the
first axis so we can label the center of each line as the announcement
date.</p>
<p>We will split this line in two to leave room for the text <code class="docutils literal notranslate"><span class="pre">Announced</span></code>
to be added soon.</p>
<p>To add the lines, we will use the data coordinate system from the first
Axes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mf">91.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">93</span><span class="p">,</span> <span class="mi">100</span><span class="p">]):</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">(</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">0.1</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2d6ad92eec2c56971f5bf14646f9bc20e7911ef804318f0c00b9de7b5a66cb3b.png" src="../_images/2d6ad92eec2c56971f5bf14646f9bc20e7911ef804318f0c00b9de7b5a66cb3b.png" />
</div>
</div>
</section>
<section id="annotations">
<h3>Annotations<a class="headerlink" href="#annotations" title="Permalink to this heading">#</a></h3>
<p>The last step on our journey is to add annotations that mark Tim Cook’s
first announcement as CEO, the lackluster market response to <code class="docutils literal notranslate"><span class="pre">S</span></code> model
announcements, and a label showing that the white dot on each subplot is
associated with the announcement date.</p>
<p>Adding text to figures is always a bit verbose, so don’t get too scared
by what is happening here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axs</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s2">&quot;Tim Cook&#39;s first iPhone</span><span class="se">\n</span><span class="s2">announcement as Apple&#39;s CEO&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">93</span><span class="p">),</span>
    <span class="n">annotation_clip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;arrowstyle&quot;</span><span class="p">:</span> <span class="s2">&quot;-|&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;connectionstyle&quot;</span><span class="p">:</span> <span class="s2">&quot;angle3,angleA=0,angleB=110&quot;</span><span class="p">,</span>
        <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span>
    <span class="p">},</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/308368811662b54865abeb8b2abb2d6a8852be13646622250619a45988f19410.png" src="../_images/308368811662b54865abeb8b2abb2d6a8852be13646622250619a45988f19410.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ann</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">texts</span><span class="p">:</span>
    <span class="n">ann</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s2">&quot;Hardware upgrade &#39;S&#39; models</span><span class="se">\n</span><span class="s2">underwhelm the market&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">92</span><span class="p">),</span>
    <span class="n">annotation_clip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;visible&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;semibold&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">pink</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8ccc549b351d80474fb246c1df2c5aa989aef33953e767c7fa30514c441bdceb.png" src="../_images/8ccc549b351d80474fb246c1df2c5aa989aef33953e767c7fa30514c441bdceb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s2">&quot;Announced&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">92</span><span class="p">),</span>
    <span class="n">annotation_clip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;visible&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8565e6f6fe6abd03c337eed6f9d8fdbc7cb87684c4a2a5ee9e605f93f4714ed7.png" src="../_images/8565e6f6fe6abd03c337eed6f9d8fdbc7cb87684c4a2a5ee9e605f93f4714ed7.png" />
</div>
</div>
</section>
</section>
<section id="saving-the-figure">
<h2>Saving the Figure<a class="headerlink" href="#saving-the-figure" title="Permalink to this heading">#</a></h2>
<p>Now that we have a finished product we are happy with, let’s save it to
a file on our computer using the <code class="docutils literal notranslate"><span class="pre">fig.savefig</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;aapl_iPhone_annoucements.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">background</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here, we asked matplotlib to save our figure in the <code class="docutils literal notranslate"><span class="pre">png</span></code> format, with
400 dots per inch (<code class="docutils literal notranslate"><span class="pre">dpi</span></code>, meaning each inch has a 400 by 400 set of
colored points).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">bbox_inches</span></code> command is needed here to make sure pandas doesn’t
chop off any of our Axes titles or tick labels.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">facecolor</span></code> argument was necessary because matplotlib
will save figures with a transparent background by default (meaning the background
is see-through so it “adopts” the background color of whatever website,
document, or presentation is is placed in).</p>
<p>We could have chosen a different file format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;aapl_iPhone_annoucements.jpeg&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">background</span><span class="p">)</span>

<span class="c1"># dpi not needed as pdf is a &quot;vector&quot; format that effectively has an infinite dpi</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;aapl_iPhone_annoucements.pdf&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">background</span><span class="p">)</span>

<span class="c1"># svg is also a vector format</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;aapl_iPhone_annoucements.svg&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">background</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h3>
<p>Phew, we made it!</p>
<p>We ended up writing quite a bit of code to get the figure to look
<em>exactly</em> how we wanted it to look.</p>
<p>Typically, our plotting code will be much more concise and simple
because we don’t usually require the same standards for aesthetic
properties as professional journalists do.</p>
</section>
</section>
<section id="exercises">
<span id="pd-mpl-ex"></span><h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this heading">#</a></h3>
<p><strong>Exercise:</strong> Using the <code class="docutils literal notranslate"><span class="pre">.plot</span></code> method, plot the opening share price
for Apple’s stock.</p>
<p>What <code class="docutils literal notranslate"><span class="pre">type</span></code> of object is returned from that method?</p>
<p>What methods does this object have?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># make plot here</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># explore methods here</span>
</pre></div>
</div>
<p>(<a class="reference internal" href="#pd-mpl-dir1"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this heading">#</a></h3>
<p>Using the <code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code> function, make a Figure with a two-by-one
grid of subplots (two rows, one column).</p>
<p>On the upper Axes, plot the adjusted close price.</p>
<p>On the lower one, plot the adjusted volume as an area chart (search for
an argument on the <code class="docutils literal notranslate"><span class="pre">plot</span></code> method to change the kind of plot).</p>
<p>Google for how to set a title for a <code class="docutils literal notranslate"><span class="pre">Figure</span></code> object and then do so.</p>
<p>(<a class="reference internal" href="#pd-mpl-dir2"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-3">
<h3>Exercise 3<a class="headerlink" href="#exercise-3" title="Permalink to this heading">#</a></h3>
<p>Take 5 minutes to explore the different arguments to the DataFrame <code class="docutils literal notranslate"><span class="pre">.plot</span></code>
method. Try to make a plot that is both good looking and interesting (
we know, those are subjective, but do your best!).</p>
<p>Some arguments you might consider exploring are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sharex</span></code> or <code class="docutils literal notranslate"><span class="pre">sharey</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">style</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grid</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">color</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kind</span></code></p></li>
</ul>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You can browse the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/visualization.html">official pandas plotting
documentation</a>
for inspiration.</p>
</div>
<p>(<a class="reference internal" href="#pd-mpl-dir3"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-4">
<h3>Exercise 4<a class="headerlink" href="#exercise-4" title="Permalink to this heading">#</a></h3>
<p>Think about  what each of the argument we passed to <code class="docutils literal notranslate"><span class="pre">.plot</span></code> does.</p>
<p>For some you might be able to guess, for others you will need to look at
the documentation.</p>
<p>For your reference, record your findings in a markdown cell below.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">to_plot.plot?</span></code> to pull up the docs.</p>
</div>
<p>(<a class="reference internal" href="#pd-mpl-dir4"><span class="std std-ref">back to text</span></a>)</p>
</section>
<section id="exercise-5">
<h3>Exercise 5<a class="headerlink" href="#exercise-5" title="Permalink to this heading">#</a></h3>
<p>For each operation in the list below (copied from above), make a note
of which functions/methods were called to achieve the result.
Edit the markdown cell containing the list directly.</p>
<p>Note: This might seem redundant since the comments above give the answers,
but forcing yourself to write out the names of the functions will help
you remember them when you need them later on.</p>
<ul class="simple">
<li><p>Change background color</p></li>
<li><p>Add Axes titles</p></li>
<li><p>Remove the x axis titles</p></li>
<li><p>Remove tick marks on y axis</p></li>
<li><p>Add a “faint” version of the line from the first subplot</p></li>
<li><p>Remove x axis tick labels</p></li>
<li><p>Make x axis ticks longer and semi-transparent</p></li>
<li><p>Make sure all Axes have same y limits</p></li>
<li><p>Remove the spines (the border on each Axes)</p></li>
<li><p>Add a white circle to (0, 100) on each Axes</p></li>
</ul>
<p>(<a class="reference internal" href="#pd-mpl-dir5"><span class="std std-ref">back to text</span></a>)</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tools"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive persistent" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/index.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/overview.html">
   Course Description
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/getting_started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/cloud_setup.html">
   Cloud Setup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/local_install.html">
   Local Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/troubleshooting.html">
   Troubleshooting
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python Fundamentals
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/index.html">
   Python Fundamentals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/basics.html">
   Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/collections.html">
   Collections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/control_flow.html">
   Control Flow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_fundamentals/functions.html">
   Functions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Scientific Computing
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/index.html">
   Scientific Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/numpy_arrays.html">
   Introduction to Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/plotting.html">
   Plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/applied_linalg.html">
   Applied Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/randomness.html">
   Randomness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scientific/optimization.html">
   Optimization
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Pandas
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/index.html">
   DataFrames and Series in Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/basics.html">
   Basic Functionality
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/the_index.html">
   The Index
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/storage_formats.html">
   Storage Formats
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/data_clean.html">
   Cleaning Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/reshape.html">
   Reshape
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/merge.html">
   Merge
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/groupby.html">
   GroupBy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/timeseries.html">
   Time series
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Science Tools
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Data Science Tools
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   Intermediate Plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="maps.html">
   Mapping in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="visualization_rules.html">
   Data Visualization: Rules and Guidelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regression.html">
   Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classification.html">
   Classification
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Applications
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/index.html">
   Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/ml_in_economics.html">
   Machine Learning in Economics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/networks.html">
   Social and Economic Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/recidivism.html">
   Case Study: Recidivism
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/working_with_text.html">
   Working with Text
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../applications/heterogeneity.html">
   Heterogeneous Effects
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="../index.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                    <!-- <li class="btn__search">
                        <form action="../search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off">
                            <i data-feather="search"></i>
                        </form>
                    </li> -->
                </ul>

                <ul class="qe-toolbar__links">
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/tools/matplotlib.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-datascience.myst/tree/main/lectures/tools/matplotlib.md" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://mybinder.org/v2/gh/QuantEcon/lecture-datascience.notebooks/main?urlpath=tree/tools/matplotlib.ipynb">BinderHub</option>
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-datascience.notebooks/blob/main/tools/matplotlib.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-datascience.notebooks" data-urlpath="tree/lecture-datascience.notebooks/tools/matplotlib.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://mybinder.org/v2/gh/QuantEcon/lecture-datascience.notebooks/main?urlpath=tree/tools/matplotlib.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "tools/matplotlib";
                const repoURL = "https://github.com/QuantEcon/lecture-datascience.notebooks";
                const urlPath = "tree/lecture-datascience.notebooks/tools/matplotlib.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>